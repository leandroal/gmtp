\chapter{Análise de Desempenho do \mudccp}
\label{cap:analisedesemp}

% http://dl.acm.org/citation.cfm?id=2557696.2557729&coll=DL&dl=ACM&CFID=405433529&
% CFTOKEN=59982670
% http://www.p2p.tu-darmstadt.de/research/overlay-streaming-simulator/
% https://github.com/ntrgiang/ossim/

índice de continuidade e outros aqui
http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=4797218


\subsection{Estudo de Caso na Rede da RNP -- Analítico}

\begin{figure}[ht]
\begin{center}
\includegraphics[natwidth=664,natheight=340,scale=.61]{imgs/rede-rnp.png}
\end{center}
\vspace{-1cm}
\caption{\textit{Backbone} da Rede Nacional de Pesquisa (RNP). 28 roteadores
espalhados em todos os estados brasileiros com 22 pontos de troca de tráfego
(PTT).}
\label{fig:rede-rnp}
\end{figure}


LINKAR TUDO APRESENTADO COMO RESULTADO À UM DESSES 3 GRUPOS:
%  \item \textit{Qualidade da experiência do usuário:} avalia-se o tempo em
% que os nós levam para começar a reproduzir os primeiros datagramas; o tempo que
% os nós levam para voltar a reproduzir o conteúdo, quando seus nós parceiros se
% desconectam da rede (índice de continuidade); e a qualidade do conteúdo recebido
% em comparação ao conteúdo original.
%
%  \item \textit{Escalabilidade dos sistemas com relação a quantidade de nós
% conectados:} avalia-se a quantidade de nós simultâneos conectados, a
% contribuição da rede CDN e da rede P2P na transmissão de um fluxo de dados, bem
% como o nível de duplicação desse fluxos.
%
%  \item \textit{Execução dos protocolos:} avalia-se a sobrecarga de controle
% gerados pelos protocolos a fim de executar suas funções.

% - http://named-data.net/wp-content/uploads/2013_Yuan_Infocom_Mini.pdf
  Olhar os gráficos desse artigo

ver ref 6386696

- Mostrar resultados que não justificam baixar chunks de múltiplos nós,
mostrando que a contagem de duplicações foi alta demais, o que resulta em
descartes no roteador e portanto, consumo desnecessário dos canais de
transmissão. A melhor parceria estará sempre no caminho até o servidor, caso
contrário, pega do servidor, o que alimenta todo o caminho e os demais pedidos
de conexão se penduram no caminho. Se não houver um caminho alimentado, uma
nova conexão no servidor e tudo se repete.

- Avaliar a quantidade de parcerias (fazer vários subgrafs mostrando a qualidade
do vídeo, pela quantidade de nós, variando-se o número de parcerias usando
\pac{GMTP-RelayQuery})

- MPEG-2, 1MB, 8s de vídeo

- Resultados
   * Comentar gráficos
   * Lembrar de falar sobre redes móveis
   * Sobre churn (roteador pode reduzir churn)
   * Quantidade de fluxos em transito

- Colocar uma seção de preâmbulo, explicando cenário e parâmetros


chunk loss ratio, chunk delivery ratio , continuity index , chunk delivery delay
, end to end delay

contagem de interceptações (isso significa uma conexão de deixou de ser
estabelecida no servidor, ou seja, menos um fluxo de dados repetido na rede)

% http://www.cs.bu.edu/brite/user_manual/BritePaper.html

denacast: in denacast every node select chunk from neighbors that have them. and
it conside balacing policy, it select chunk from neighbor that have more upload
bandwidth

thanks for your answer. this works for neighbor selection but , what about chunk
selection? i mean is there any priority based policy to download some particular
chunks sooner than the others? for example (rarest first policy or something
else) ? no , in denacast this policy (rarest)has not benn consider

Current version of denacast is a mesh topology P2P video streaming.
But what is your idea about tree topology. Is it a distributed tree or local
tree?
For creation of distributed tree topology you must change the overlay structure
of denacast.
But for local or push-pull based you can do it in the application layer.
Regards,

=========

A Survey of Peer-to-Peer Simulators and Simulation Technology
%http://www.aicit.org/jcit/ppl/JCIT_MAY_30.pdf

- Fazer gráficos
   * Gráfico que mostra o consumo de memória de um repass, dependendo da
qualidade da mídia. Será que dar pra fazer o de consumo de processamento?
   * Avaliar o uso de memória para cache de playback, colocar uma tabela os
principais formatos e o tempo gasto
   * Usar baseline
   * Usar Coolstreaming / Denacast
   * Startup time
   * Distorção
   * Restart time
   * Quantidade de nós
   * Lembrar do churn e da heterogeneidade
   * Além destas, duas outras métricas são discutidas em uma perspectiva mais
geral: a escalabilidade da quantidade de nós em uma transmissão e o impacto do
\textit{churn} nos sistemas de transmissão de conteúdos ao vivo.


=========

 e de um proeminente protocolo de
distribuição de conteúdos
multimídia ao vivo, o Denacast~\cite{REF}, uma versão estendida do
CoolStreaming~\cite{REF,REF} com suporte a uma rede híbrida P2P/CDN, detalhado
no Capítulo~\ref{cap:trabalhosrelacionados}


Devido a complexidade para
realizar experimentos reais dos cenários de aplicação, constituiu-se os
resultados com base em um ambiente de simulação que permite determinar as
configurações e avaliar os limites e os impactos dos recursos propostos com
relação às métricas de estudo estabelecidas.

=========

avaliar a capacidade do protocolo em lidar com o \textit{churn} dos nós
e o impacto disso sobre a qualidade de experiência Além disso, avaliar o impacto
do comportamento de participação dos nós sob outros nós na rede, como por
exemplo, o impacto sob a qualidade do conteúdo multimídia recebido por um nó
quando há uma falha em um nó de repasse, ou ainda, qual é o máximo atraso
aceitável sem que o usuário perceba interrupções na reprodução do conteúdo
multimídia.

=========


Neste capítulo, apresentam-se os resultados preliminiares do uso do protocolo
\mudccps para a transmissão de fluxos de dados multimídia em cenários
com muitos nós receptores. Os resultados estão organizados de acordo com três
métricas avaliadas, a escalabilidade quanto ao número de nós clientes
interessados por um mesmo fluxo de mídia, a taxa de transmissão e o atraso.
Essas métricas foram escolhidas segundo as sugestões de avaliação de protocolos
apresentadas no documento \textit{Metrics for the Evaluation of Congestion
Control Mechanisms} (RFC 5166)~\cite{RFC5166}.

\section{Análise da Escalabilidade do Número de Clientes}

Em se tratando da redução da quantidade de conexões simultâneas ao servidor por
parte dos clientes, este tem sido um aspecto fundamental do \mudccp. Isto
porque ao utilizar-se do \mudccp, constata-se uma redução significativa
na quantidade de fluxos de dados no servidor se comparado ao protocolo DCCP.

Observando-se o gráfico na Figura~\ref{fig:escala1-gmtp-dccp-tcp},
nota-se que no nível 9 da topologia de rede utilizada, fazem-se necessárias
10230 conexões simultâneas dos clientes ao servidor. Seguindo-se esta
constatação, observa-se que ao utilizar o protocolo \mudccps são
realizadas, no máximo 1023 conexões (pior caso). O pior caso acontece se cada
nó localizado em cada rede local distinta não encontrar um nó relay, sendo
necessário um cliente por rede local estabelecer uma conexão direta com o
servidor. Este pior caso é muito difícil de acontecer, pois o mecanismo de busca
por nós relays empregado no \mudccps cuidará de encontrá-los, evitando-se
conexões desnecessárias no servidor, exceto se o nó relay estiver 5 saltos de
distância do cliente interessado pelo fluxo de dados.

\begin{figure}[htb!]
\begin{center}
\includegraphics[scale=.65]{graphs/5.pdf}
\end{center}
\vspace{-1cm}
\caption[Quantidade de conexões simultâneas do \mudccps e o DCCP]{Gráfico da
quantidade de conexões simultâneas ao servidor com o uso dos protocolos \mudccps
e o DCCP.}
\label{fig:escala1-gmtp-dccp-tcp}
\end{figure}

Nas simulações de rede executadas, avaliou-se a evolução do protocolo \mudccps
quanto à disponibilidade de nós relays e o uso destes por parte dos
clientes. No caso da topologia de rede utilizada nas simulações, constatou-se
apenas duas conexões ao nó servidor e em cada nó relay (melhor caso). Isto
porque a quantidade de níveis da árvore da topologia de rede foi pequena
(apenas 10 níveis), então os clientes localizados em níveis mais extremos da
topologia da rede não alcançou o limiar de atraso necessário para ativar o
mecanismo empregado no \mudccps de conexão direta ao servidor, sem o uso de nós
relays. Este aspecto do \mudccps foi discutido no final da
Seção~\ref{sec:conexaomudccp}. Neste contexto, faz-se necessário mais estudos
de simulações a fim de atingir o limiar de atraso configurado pela aplicação e
então avaliar o comportamento do \mudccps no tocante à quantidade de conexões
simultâneas que serão necessárias ao nó servidor caso aconteça esta situação.
Mais adiante na Seção~\ref{sec:atras-result} serão discutidos outros resultados
relacionados ao atraso com o uso do \mudccp.

\begin{figure}[htb!]
\begin{center}
\includegraphics[scale=.85]{graphs/2.pdf}
\end{center}
\vspace{-1cm}
\caption[Taxa média de recepção e perda de pacotes com \mudccps e DCCP]{Gráfico
da taxa média de recepção e perda de pacotes pela quantidade de nós clientes
entre o nível 1 (10 clientes) e o nível 9 (10230 clientes), utilizando-se os
protocolos \mudccps e DCCP.}
\label{fig:escala2-gmtp-dccp-tcp}
\end{figure}

Dando continuidade às discussões acerca da escalabilidade do \mudccps no quesito
de número de clientes interessados pelo mesmo fluxo de dados, no gráfico da
Figura~\ref{fig:escala2-gmtp-dccp-tcp}, observa-se um comparativo do
comportamento do uso do \mudccps e a taxa de transmissão média obtida por cada
nó cliente à medida que aumentou-se o número de clientes (níveis 0-9).
Constata-se claramente que quando se compara o comportamento do \mudccps e do
DCCP, com o uso do
\mudccp, melhora-se sobremaneira a taxa efetiva de recepção de dados
por parte dos nós clientes, ao passo que a quantidade de perda de pacotes de
dados por parte do DCCP aumenta exponencialmente. Observa-se que mesmo
aumentando a quantidade de nós clientes, por exemplo, entre 150 e 2550, a
taxa de transmissão média continuou sendo satisfatória, sendo crescente à medida
que aumentou-se a quantidade de nós clientes. Isso é justificado pelo fato de
que quanto mais nós \mudccps na rede, aumentam-se as chances de mais nós
clientes se tornaram relays, o que consequentemente aumentam as chances de
existirem mais clientes recebendo fluxos de dados em modo multicast e não
somente em modo unicast.

\section{Análise da Taxa de Transmissão}

O estudo da métrica \textit{taxa de transmissão} ocorreu através da análise do
comportamento dos protocolos \mudccp, DCCP e TCP para a transmissão de fluxos de
dados multimídia no cenário apresentado no
Capítulo~\ref{cap:metodosexperimentos}.

No gráfico apresentado na Figura~\ref{fig:vazao-gmtp-dccp-tcp}, observa-se o
comportamento dos protocolos estudados quando utilizados em uma transmissão de
vídeo, segundo as considerações estabelecidas na Seção~\ref{sec:paramexp}. No
eixo das abscissas representa-se o tempo de simulação em segundos, ao passo que
no eixo das ordenadas representa-se a taxa de transmissão obtida a cada segundo.
Note que os valores plotados no gráfico refletem a taxa de recepção para um dos
ensaios efetuados do Tratamentos 1. A quantidade de repetições realizadas
para cada protocolo, assim como um sumário dos valores de todas as métricas
estudadas são apresentadas na Seção~\ref{sec:sumario-results}.

De acordo com o gráfico, observa-se um desempenho superior do protocolo \mudccps
com relação à taxa de recepção obtida pelos nós clientes, comparando-o com o TCP
e com o DCCP. Percebe-se que o TCP e o DCCP tiveram comportamentos
semelhantes, com uma leve vantagem para o protocolo DCCP. Note que o fluxo de
dados transmitido pelo \mudccps se mantém de forma estável, entre \ut{18}{Mbps}
e \ut{22}{Mbps}. A principal explicação para o desempenho satisfatório do
\mudccps com relação a taxa de transmissão é porque tal protocolo faz uso do
compartilhamento de conexões para obtenção do conteúdo multimídia, obtendo-se
o conteúdo através de nós relays, que repassa para seus nós próximos os pacotes
de dados em modo multicast, sempre que possível.

Além disso, o \mudccps faz uso de um algoritmo para controle de congestionamento
híbrido, tratando-se de formas distintas a forma como os recursos de rede são
consumidos \textit{intra} e \textit{inter} redes. Consequentemente,
utilizando-se de forma mais eficiente os canais dos \textit{backbones} com alta
disponibilidade de largura de banda (os canais de \ut{1}{Gbps} da topologia de
rede utilizada), ao passo que minimiza o congestionamento nas redes
locais, reduzindo-se significativamente a quantidade de conexões simultâneas no
servidor ao utilizar o modo de transmissão multicast.

\begin{figure}[htb!]
\begin{center}
\includegraphics[scale=.8]{graphs/4.pdf}
\end{center}
\vspace{-1.0cm}
\caption[Taxa de recepção do \mudccp, DCCP e TCP]{Gráfico
da taxa de recepção para 10230 clientes (nível 9), considerando-se o uso dos
protocolos \mudccp, DCCP e TCP em uma transmissões de vídeo.}
\label{fig:vazao-gmtp-dccp-tcp}
\end{figure}

\section{Análise do Atraso Fim-a-Fim}
\label{sec:atras-result}

Após uma avaliação do comportamento do \mudccps com relação a métrica taxa de
transmissão e escalabilidade do protocolo, apresenta-se agora discussões acerca
da métrica \textit{atraso}. No gráfico ilustrado na
Figura~\ref{fig:atraso-gmtp-dccp}, apresenta-se a evolução do atraso com relação
aos protocolos \mudccps e o DCCP, considerando-se a topologia de rede estudada.
No eixo das abscissas, representa-se a distância entre um grupo de clientes (os
níveis da árvore da topologia de rede utilizada) até o servidor localizado na
raíz da árvore, ao passo que no eixo das ordenadas representa-se a média do
atraso de recepção observado em cada nó \mudccp.

Note que, à medida que a distância em saltos aumenta entre um nó cliente
(níveis mais altos da topologia de rede) e o servidor localizado na raíz, o
atraso de recepção aumenta exponencialmente para cada cliente DCCP. Não
observa-se este fato ao utilizar o protocolo \mudccp, onde o aumento do atraso
de recepção é linear e suave. De fato, isto ocorre por conta do uso da
combinação do modo de transmissão unicast e multicast empregado no \mudccp.
Ao utilizar o protocolo DCCP, muitas conexões são abertas ao servidor, o que
resulta em múltiplos fluxos com conteúdos iguais que são transmitidos na rede,
fazendo-se mal uso do canal de transmissão e elevando-se o nível de
congestionamento da rede. A consequência disso é uma inundação de pacotes de
dados no roteador que, quando estes não os destartam, demoram demasiadamente
para processá-los, o que aumenta o atraso fim-a-fim.

\begin{figure}[htb!]
\begin{center}
\includegraphics[scale=.85]{graphs/3.pdf}
\end{center}
\vspace{-1cm}
\caption[Atraso médio de recepção de pacotes com \mudccps e DCCP]{Gráfico do
atraso médio de recepção de pacotes de dados pela quantidade de nós receptores,
entre o nível 1 (10 clientes) e o nível 10 (10230 clientes) da topologia de rede
estudada, considerando-se o uso dos protocolos \mudccps e DCCP.}
\label{fig:atraso-gmtp-dccp}
\end{figure}

% \section{Análise de Qualidade de Vídeo}
%
% \section{Análise do Tempo de Descoberta de Relays}


\section{Compilação dos Resultados}
\label{sec:sumario-results}

Na Tabela~\ref{tab:result-vazao}, apresenta-se um sumário das métricas
taxa de transmissão, quantidade de dados transmitidos e perdidos, atraso e
o número de repetições dos tratamentos para os protocolos \mudccp, DCCP
e TCP. Considera-se importante salientar a quantidade de repetições que foram
realizadas durante a execução dos tratamentos. Os valores apresentados na coluna
\textit{n} da Tabela~\ref{tab:result-vazao} expressa a quantidade de vezes que
um determinado tratamento foi repetido, utilizando-se todo o suporte
estatístico discutido na Seção~\ref{sec:metestat}.

De acordo com os valores apresentados na Tabela~\ref{tab:result-vazao},
constata-se que para as métricas avaliadas, o \mudccps promove melhorias
significativas se comparado ao uso de protocolos tradicinais, tais como o DCCP e
o TCP em cenários de aplicações estudados neste trabalho. Observou-se melhorias
da taxa de transmissão média obtida por um fluxo \mudccps de quase 211 vezes
mais, comparando-se ao DCCP e de quase 320 vezes mais comparando-se ao TCP. Além
disso, obteve-se melhoras bastante expressivas com o uso do \mudccps com relação
às métricas de quantidade de dados efetivamente transmitidos e o atraso.

Considerando-se a taxa de transmissão média obtida por cada fluxo de dados
\mudccp, conseguiu-se transmitir, em média, \ut{29103,8}{MBytes}, com perda
apenas de \ut{724}{MBytes}. Comparando-se o desempenho do \mudccps aos
protocolos DCCP e TCP, o resultado é bastante satisfatório. Com o uso do DCCP,
transmitiu-se efetivamente apenas \ut{87,62}{MBytes}, de \ut{141,62}{MBytes}
originados do
servidor. Já com o uso do TCP, transmitiu-se apenas \ut{28,15}{MBytes}, de
\ut{141,62}{MBytes} originados do servidor. Este resultado obtido com o uso do
TCP é muito ruim porque tal protocolo implementa retransmissão de dados e
a perda de dados causa a redução da taxa de transmissão e o aumento do atraso
fim-a-fim devido ao acumulo de dados que precisa ser retransmitido.

Já com relação ao atraso, observa-se um tempo de atraso muito menor do \mudccps
se comparado aos protocolos DCCP e TCP. Enquanto que a média de atraso entre
pacotes (\textit{jitter}) ao utilizar o \mudccps foi de \ut{7,23}{ms}, o atraso
médio observado pelos nós DCCP e TCP foram \ut{88,34}{ms} e \ut{288,64}{ms},
respectivamente.

% este cálculo está errado? A multiplicação deve ser feita por vazão * 1460 *
% 400, que é o tempo de simulação. Os dados atuais representam apenas 1s de
% transmissão

\renewcommand\multirowsetup{\centering}
\begin{center}
\footnotesize
\begin{longtable}[tp]{c|c|c|c|c}
\caption[Sumário de desempenho dos protocolos \mudccp, DCCP e TCP.]{Sumário da
taxa de transmissão, quantidade de dados transmitidos e perdidos e o atraso para
os protocolos \mudccp, DCCP e TCP.} \label{tab:result-vazao} \\

\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Protocolos}} &
\multirow{2}{2.8cm}{\textcolor{black}{\bfseries Taxa de Trans. (Mbps)}}
&
\multirow{2}{3.3cm}{\textcolor{black}{\bfseries Transmitido / Perdido (MBytes)}}
&
\multirow{2}{2.0cm}{\textcolor{black}{\bfseries Atraso (ms)}} &
\multirow{2}{2.2cm}{\textcolor{black}{\bfseries Repetições (n)}} \\
%\rowcolor[gray]{0.8}
 & & & & \\
\hline \hline
\endfirsthead

\multicolumn{5}{c}%
{{\bfseries \tablename\ \thetable{} -- continuação da página anterior}} \\
\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Confrontos}} &
\multirow{2}{2.8cm}{\textcolor{black}{\bfseries Taxa de Trans. (Mbits/s)}}
&
\multirow{2}{3.3cm}{\textcolor{black}{\bfseries Transmitido / Perdido (MBytes)}}
&
\multirow{2}{2.0cm}{\textcolor{black}{\bfseries \emph{Jitter} (ms)}} &
\multirow{2}{2.2cm}{\textcolor{black}{\bfseries Repetições (n)}} \\
%\rowcolor[gray]{0.8}
 & & & & \\
\hline \hline
\endhead

\hline\hline \multicolumn{5}{c}{Continuação na próxima página} \\ \hline \hline
\endfoot

\hline \hline
\endlastfoot

% INICIO DE LINHA

\multirow{2}{*}{\textcolor{black}{\bfseries GMTP}} & $20,43$ & $29103,8$
& $7,23$ & \multirow{2}{*}{$32$} \\
& $(18,96 - 21,9)$ & $(29707,6 - 29948)$
& $(6,39 - 8,07)$ \\ \cline{1-5}

\multirow{2}{*}{\textcolor{black}{\bfseries DCCP}} & $0,097$ & $87,62$
& $88,34$ & \multirow{2}{*}{$29$} \\
& $(0 - 0,12)$ & $(77,48 - 97,76)$
& $(86,5 - 90,18)$ \\ \cline{1-5}

\multirow{2}{*}{\textcolor{black}{\bfseries TCP}} & $0,064$ & $28,15$
& $288,64$ & \multirow{2}{*}{$37$} \\
& $(0 - 0,084)$ & $(18,84 - 37,46)$
& $(287,39 - 289,89)$ \\ \cline{1-5}

\end{longtable}
\end{center}

\vspace{-1cm}

\section{Sumário do Capítulo}

Neste capítulo, apresentou-se os resultados preliminares do uso do protocolo
\mudccps em um cenário de transmissão de vídeo com um único nó transmissão e
milhares de nós receptores.

As métricas estudadas foram a taxa de transmissão, o atraso e a
escalabilidade quanto ao número de nós clientes interessados por um mesmo fluxo
de mídia. Os resultados foram apresentados através de gráficos e as discussões
foram feitas a fim de prover ao leitor e desenvolvedores de aplicações razões
que justificam o uso do \mudccps em suas aplicações.

Durante todo o processo de discussão acerca dos resultados obtidos, comparou-se
o desempenho do \mudccps em relação aos protocolos DCCP e o TCP, onde
constatou-se melhorias significativas para as métricas estudadas do uso do
protocolo \mudccps em transmissões de conteúdos multimídia para $10230$ nós
receptores.

De acordo com os resultados apresentados ao longe deste capítulo e discussão
apresentada na Seção~\ref{sec:sumario-results}, constatou-se que o desempenho do
\mudccps foi significamente superior em todas as métricas estudadas se
comparado aos outros protocolos analisados.

% Gráfico de fairness
% TCP-Friendliness
% Intra-Protocol Fairness
% Responsiveness
% Varying Off Times
% Fairness at Different Application Sending Rates
% Low Levels of Statistical Multiplexing
% Fairness for Different Combinations of Flows
% http://www.faqs.org/rfcs/rfc5166.html