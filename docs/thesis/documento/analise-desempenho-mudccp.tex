\chapter{Análise de Desempenho e do Projeto \mudccp}
\label{cap:analisedesemp}

% ====
% 
% * Qual é a diferença entre um ensaio, uma simulação e um experimento?
% * Melhores práticas em design de experimentos sugerem 20 (ou 10 ou 5) experimentos para estimar o desvio padrão da população inicialmente.
% 
% * Me parece que o raciocínio na página 105 está errado. É possível construir um intervalo de confiança de 95\% para a média de uma população com qualquer quantidade de amostras. O que é o intervalo de confiança de 95\% sendo construído na equação 5.11?
%      - Me parece que é um IC com largura igual a 10\% do valor da média. O texto estaria então conceitualmente errado.
% 
% * Não entendi o experimento: a impressão que dá é que ele compara a transmissão em árvore vs. uma transmissão centralizada. O DCCP tem que ser usado de maneira cliente-servidor? Se não, a comparação é absolutamente injusta. Os experimentos deveriam considerar dois sistemas P2P, um implementado com GMTP e outro com DCCP, não? Agora parece uma comparação de multicast vs. unicast, que já foi feita 20 anos atrás.
%      - Não é bem assim! O GMTP não usa multicast exclusivamente
%      - Dizer que o Denacast faz multicast local tb
% 
% * p15: Você diz que o DCCP não é escalável: o problema me parece ser na arquitetura que você usou, e não no protocolo ponto-a-ponto. Ele pode ser usado para implementar uma mesh.
%      - Sim! Tenho que mudar essa visão. O cara pode fazer P2P com DCCP. OK! Então o foco é investir no papo de que o P2P com GMTP está na infraestrutura, escalar está na essência do protocolo, ao passo que usar outros protocolos isso deve ser feito individualmente. OK! Mas o cara pode querer ter flexibilidade na aplicação, aí faz sua própria solução e perde tudo o que o GMTP pode oferecer. Alternativamente, o cara pode fazer um novo GMTP-Intra e aproveitar tudo disponíveis no GMTP-Inter.
% 
% * p16 (fim): controlar o congestionamento e evitar a tragédia dos bens comuns não é a mesma coisa?
%      - 
% 
% * p17: na sua tese, o que seria um resultado que a negaria? Ela não pode ser óbvia.
%      - Um protocolo que comprovasse fazer melhor do que o GMTP considerando apenas a comunicação end-to-end, com suporte a controle de congestionamento (o que mais??)
%      - Seleção de nós é importante
% 
% * Eu entendo que a implementação é meio e não fim na sua tese. Não devia ser um objetivo. O objetivo não seria obter uma solução para um problema X com propriedades Y, Z e W?
%      - Revisar se o papo na introdução está com essa cara
% 
% * Não entendi o experimento: a impressão que dá é que ele compara a transmissão em árvore vs. uma transmissão centralizada. O DCCP tem que ser usado de maneira cliente-servidor? Se não, a comparação é absolutamente injusta. Os experimentos deveriam considerar dois sistemas P2P, um implementado com GMTP e outro com DCCP, não? Agora parece uma comparação de multicast vs. unicast, que já foi feita 20 anos atrás.
%      - Concordo!
% 
% No planejamento:
%      - É necessária uma fase de experimentos de simulação para explorar e justificar as decisões de design, parâmetros e permitir o estudo da contribuição do trabalho
% 
% ====

% Neste capítulo, apresentam-se as análises do projeto e do desempenho do GMTP para distribuição de mídias ao vivo. Na Seção~\ref{sec:analisedeproj} (análise do projeto), generaliza-se a discussão acerca dos serviços disponibilizados no GMTP em comparação àqueles implementados nos principais sistemas. Na Seção~\ref{sec:analisedesemp} (análise de desempenho), estabelecem-se confrontos entre uma implementação de referência do GMTP, o Denacast/CoolStreaming e o CCN/TV, em um ambiente de simulação que proporcionou a obtenção de valores para as métricas avaliadas em um cenário que simula parte da Internet. Por fim, na Seção~\ref{sec:resdisc-sumario}, apresenta-se o sumário deste capítulo.
% 
% Com essa estratégia, possibilita-se aprofundar o entendimento sobre o GMTP em duas vertentes (projeto e desempenho), estudando-o por meio de diferentes configurações de rede e identificando-se suas vantagens e limitações em comparação ao estado da arte e da prática.

Como apresentou-se no Capítulo~\ref{cap:introducao}, o objetivo deste trabalho compreende três grandes fases: 1) revisão das técnicas e propostas para distribuição de mídias ao vivo; 2) descrever o protocolo GMTP; e 3) a avaliação do uso do GMTP para distribuição de mídias ao vivo. Nos Capítulos~\ref{cap:fundamentacao} e~\ref{trabalhosrelacionados}, contemplou-se a Fase 1; no  Capítulo~\ref{cap:mudccp}, a Fase 2 e, neste capítulo, concentram-se as discussões na Fase 3.

O objetivo desta fase foi avaliar o protocolo GMTP frente às propostas Denacast/CoolStreaming~\cite{Jahromi2012,5764567} e o CCN-TV~\cite{6550523}. Considerou-se dois principais critérios de seleção dessas propostas, em comparação ao GMTP: similaridade arquitetural e os recursos disponíveis para distribuição de um fluxo de dados ao vivo. Tratam-se de duas propostas que consideram a maioria das estratégias adotadas no estado da prática/arte para distribuição de mídias ao vivo, sendo tais propostas referenciadas na literatura e acessíveis para estudos comparativos.

% Nesse contexto, considera-se que as avaliações são equânimes, pois o Denacast/CoolStreaming estende o funcionamento do CoolStreaming para dar suporte a uma estrutura P2P/CDN, o CCN-TV faz uso de uma infraestrutura que considera mais efetivamente o suporte da rede para otimizar o acesso aos dados e o GMTP essencialmente explora uma estratégia híbrida se considerado seus concorrentes.

O restante deste capítulo esta organizado da seguinte forma: na Seção~\ref{sec:metodologia}, apresenta-se a metodologia de avaliação. Na Seção~\ref{sec:resdisc}, discutem-se os resultados da avaliação. E, por fim, na Seção~\ref{sec:resdisc-sumario}, sumariza-se este capítulo.

% PENSAR EM ALGUM GRÁFICO PARA COLOCAR LÁ NA PROBLEMÁTICA?

\section{Metodologia}
\label{sec:metodologia}

Para realizar a comparação entre protocolos supracitados, definiu-se a modalidade de avaiação experimental em um ambiente de simulação de rede que proporcionou a construção de um cenário de rede para este fim. Através da definição de fatores (variáveis independentes), mediu-se e analisou-se as principais métricas (variáveis dependentes) que determinam a experiência do usuário ao assistir a um evento através de um sistema de distribuição de mídias ao vivo. Dessa forma, possibilitou-se aprofundar o comportamento do GMTP em relação ao estado da arte/prática, estudando-o em diferentes configurações de rede a fim de determinar suas vantagens, limites e os impactos que seus recursos podem gerar tanto sobre os nós quanto sobre a rede.

Sendo assim, a seguir, apresentam-se detalhes do projeto experimental executado, organizado em objetivo e hipótese, instrumentação, topologia de rede, variáveis independentes e dependentes, fatores, população e amostras, formato da mídia utilizada e os tratamentos.

\subsection{Objetivo e hipótese}

O objetivo do experimento foi avaliar o desempenho do GMTP com vistas à hipótese enunciada de que a constituição de uma rede de favores entre roteadores que interceptam, realizam cache temporário e compartilham pacotes de dados tanto em modo \textit{multicast} (em redes locais) quanto em modo unicast (entre redes distintas), auxiliados por um algoritmo para controle de congestionamento assistido pela rede, resulta em uma melhor distribuição dos fluxos de mídias ao vivo.

Para provar esta hipótese, organizou-se a avaliação experimental em duas etapas. Na primeira, confrontou-se o GMTP com o Denacast/CoolStreaming e, na segunda, confrontou-se o GMTP com o CCN-TV. Em ambas as etapas, analisaram-se os valores obtidos referentes às métricas que determinam a qualidade de serviço para distribuir mídias ao vivo, comparando-se o desempenho dos protocolos estudados.

% Em cada etapa, definiu-se uma hipótese nula ($H_0$) e uma hipótese alternativa ($H_A$), da seguinte forma:
% 
% \begin{enumerate}
% 
%   \item \textit{GMTP vs. Denacast/CoolStreaming}:
%   \begin{itemize}
% 
%     \item $H_0$: a eficácia do GMTP e a do Denacast/CoolStreaming é igual, considerando-se as métricas que determinam a qualidade de serviço para distribuição de mídias ao vivo.
% 
%     \item $H_A$: a eficácia do GMTP e do Denacast/CoolStreaming é diferente, considerando-se as métricas que determinam a qualidade de serviço para distribuição de mídias ao vivo.
% 
%   \end{itemize}
% 
%   \item \textit{GMTP vs. CCN/TV}: 
%   \begin{itemize}
% 
%     \item $H_0$: a eficácia do GMTP e do CCN-TV é igual, considerando-se as métricas que determinam a qualidade de serviço para distribuição de mídias ao vivo.
% 
%     \item $H_A$: a eficácia do GMTP e do CCN-TV é diferente considerando-se as métricas que determinam a qualidade de serviço para distribuição de mídias ao vivo.
% 
%   \end{itemize}
% 
% \end{enumerate}



\subsection{Topologia de rede}

Com esse norte, primeiramente definiu-se a topologia da rede. Como ilustra-se na Figura~\ref{fig:rede-geant}, simulou-se o \textit{backbone} da rede GEANT\footnote{Rede GEANT: http://www.geant.net/.}. Atualmente, a GEANT interconecta 10.000 instituições europeias de pesquisa e educação e 50 milhões de usuários, composta por 41 roteadores conectados por meio de canais de transmissão com capacidades que variam entre \ut{1}{Gbps} e \ut{100}{Gbps}. No caso da simulação, utilizou-se apenas \ut{10}{\%} da capacidade de transmissão original da rede, a fim de gerar pontos de super utilização de acordo com a quantidade de nós clientes interessados em receber um fluxo de dados ao vivo.

\begin{figure}[b!ht]
\begin{center}
\includegraphics[natwidth=1110,natheight=939,scale=.34]{imgs/rede-geant.png}
\end{center}
\vspace{-0.8cm}
\caption{\textit{Backbone} da rede GEANT.}
\label{fig:rede-geant}
\end{figure}

DEIXAR MAIS CLARO COMO OS NÓS SE CONECTARAM, TALVEZ DESENHAR ALGO EM CIMA DESSA FIGURA.

\subsection{Definição de Variáveis}

As variáveis foram definidas em 3 categorias: independentes, fatores e independentes.

\subsubsection{Variáveis independentes:}

Na Tabela~\ref{tb:variaveis-independentes}, apresentam-se as variáveis independentes utilizadas no experimento, com base na topologia da rede apresentada anteriormente.

\begin{table}[b!ht]
  \centering
  \caption{Tabela das variáveis independentes utilizados no experimento.}
  \renewcommand{\arraystretch}{1}% Spread rows out...
  \begin{tabular}{>{}m{2.6in} >{}m{3.2in}}
    \toprule
    \textbf{Parâmetros} & \textbf{Valores} \\
    \midrule
    Tipo da mídia$^1$ & MPEG4 Part I \\
    Número de nós roteadores (\textit{backbone}) & 41 \\
    Tempo de simulação de cada ensaio & \ut{900}{s} \\
    Largura de banda das LANs & \ut{100}{Mbps} \\
    Atraso das LANs & $\le$ \ut{1}{ms} \\
    Largura de banda da WAN$^2$ & \ut{10}{\%} da capacidade total do canal \\
    Tamanho do buffer do roteador & \ut{8}{s} (por mídia) \\
    Tamanho máximo do datagrama & \ut{1500}{Bytes} (OverSim) e \ut{4096}{Bytes} (CCNSim)\\
    Taxa de upload dos nós$^3$ & \ut{512}{Kbps}, \ut{1}{Mbps}, \ut{2}{Mbps} (Heterogênea) \\
    Dinâmica da rede (\textit{churn})$^4$ & RandomChurn \\
    \bottomrule
  \end{tabular}
  \\\scriptsize\raggedright
  $^1$ Para mais detalhes, consultar Seção~\ref{subsec:tipomidia}.\\
  $^2$ Por exemplo, nos canais ilustrados na cor preta da Figura~\ref{fig:rede-geant}, utilizou-se \ut{10}{Gbps} em vez de \ut{100}{Gbps}.\\
  $^3$ Alocaram-se valores aleatórios com base em distribuição uniforme.\\
  $^4$ \textit{RandomChurn}: a cada intervalo de \ut{3}{s}, um número \textit{x} $\in$ $[0,1]$ foi gerado. Dependendo do valor de \textit{x}, nós foram mantidos ou removidos com uma probabilidade \textit{p} a cada ensaio. Utilizou-se $p=0.7$, isto é, os nós foram mantidos com uma probabilidade de \ut{70}{\%} e removidos com uma probabilidade de \ut{30}{\%}. Note que essa função foi iniciada após \ut{400}{s} do início de cada ensaio. \\
  \normalsize
  \label{tb:variaveis-independentes}
\end{table}

\subsubsection{Fatores:}

Na Tabela~\ref{tb:fatores}, apresentam-se fatores consideradas no experimento, os quais seus valores foram variados de um tratamento para outro.

\begin{table}[b!ht]
  \centering
  \caption{Tabela dos fatores consideradas no experimento.}
  \renewcommand{\arraystretch}{1}% Spread rows out...
  \begin{tabular}{>{}m{2.2in} >{}m{3.6in}}
    \toprule
    \textbf{Fatores} & \textbf{Valores} \\
    \midrule
    Número de nós servidores$^1$ & 1, 3, 7 \\
    Número de nós clientes$^2$ & 500; 1.500; 15.000; 30.000; 60.000; 80.000; 100.000 \\
%     Suporte da rede ao protocolo$^2$ & Borda e Total \\
    \bottomrule
  \end{tabular}
  \scriptsize\raggedright
  \begin{spacing}{0.5}
    $^1$ Acima de 1, os nós clientes solicitaram conexão a um sevidor escolhido aleatoriamente.\\
    $^2$ Todos os clientes solicitaram a mídia nos primeiros \ut{200}{s} de cada ensaio. Para isto, gerou-se uma quantidade igual de números inteiros entre 0-200 correspondente à quantidade de nós clientes a serem conectados.
%     $^2$ Apenas no confronto GMTP vs. CCN-TV. \textit{Borda:} suporte apenas nos roteadores conectados na borda da rede. \textit{Total:} suporte em todos os roteadores da rede.
  \end{spacing}  
  \label{tb:fatores}
\end{table}

% Total de 360
% 

\subsubsection{Variáveis dependentes:}

As principais métricas para medir um sistema de distribuição de mídias ao vivo podem ser organizadas em três categorias~\cite{5343509}, apresentadas a seguir. 

\begin{enumerate}

 \item \textit{Qualidade de serviço à aplicação:} avaliam-se o atraso para iniciar a reprodução de uma mídia ao vivo após o primeiro pedido (ST); o índice de continuidade (IC); e o nível de distorção (qualidade) do conteúdo recebido em comparação ao conteúdo original (DI). A variável IC é o tempo total de recepção da mídia, desde da recepção do primeiro pacote de dados até sua desconexão (seja em função do \textit{churn} ou pelo término do ensaio), menos o tempo de todas as interrupções nesse período (representado em porcentagem). Para a variável DI o raciocínio é semelhante, ou seja, a distorção da mídia foi medida apenas entre o instante da recepção do primeiro pacote de dados até sua desconexão, pelos mesmos motivos citados anteriormente.

% Distorção:
% \begin{verbatim}
% Vídeo original: ======================================== 100%
% Vídeo recebido: =====    ====   =====    ===============  70%
% \end{verbatim}

%   1 interrupção de 6 segundos == 2 interrupções de 3 segundos
%   Acho que uma interrupção mais longa é mais grave do várias interrupções mais curtas: uma interrupção mais longa dificulta o usuário entender mais o contexto se comparado a várias interrupções mais curtas

 \item \textit{Escalabilidade do sistema:} avalia-se a quantidade de nós simultâneos que foram capazes de receber o fluxo de dados da mídia transmitida com um nível de distorção máximo (ES). Nesse caso, mediu-se o nível de contribuição das redes CDN e P2P separadamente, que corresponde à quantidade de fluxos transmitidos pelos servidores (QS) da CDN e pelos nós da rede P2P (QP).

 \item \textit{Sobrecarga de controle:} avalia-se a quantidade de pacotes de controle (PC) transmitidos por um protocolo durante o tempo de simulação (contagem dos pacotes que não transportam dados da mídia), mas considera-se 0,5 cada pacote de \textit{piggyback}. 

\end{enumerate}

Com base nessas métricas, determinou-se as variáveis dependentes, como apresentam-se na Tabela~\ref{tb:variaveis-dependentes}.

\begin{table}[b!ht]
  \centering
  \caption{Tabela das variáveis dependentes (respostas) consideradas no experimento.}
  \renewcommand{\arraystretch}{1}% Spread rows out...
  \begin{tabular}{>{}m{4.1in} >{}m{1.0in}}
    \toprule
    \textbf{Variáveis dependentes} & \textbf{Símbolo} \\
    \midrule
    Atraso de inicialização do fluxo & ST \\
    Índice de continuidade (\%) & IC \\
    Distorção do vídeo (\%) & DI \\
%     Número de clientes com recepção acima de X\%$^1$ da mídia & ES \\
    Número de conexões ao servidor & QS \\
    Número de conexões entre clientes & QP \\
    Número de pacotes de controle & PC \\
    \bottomrule
  \end{tabular}
%   \scriptsize\raggedright
%   \begin{spacing}{0.5}
%     $^1$ As faixas dos valores de X são 0--20\%, 21--40\%, 41--60\%, 61--80\%, 91--100\%.\\
%   \end{spacing}
  \label{tb:variaveis-dependentes}
\end{table}


% Métricas:
%    - Atraso de inicialização do fluxo
%    - Índice de Continuidade / Quantidade de interrupções / tempo de recuperação (?)
%    - Distorção do conteúdo recebido em comparação ao transmitido
%    - Sobrecarga de controle
%    - Número de conexões no servidor / entre nós
%    - Número de nós clientes que receberam 90%, 80% e 70% da mídia do total de nós na rede
%    - Qualidade das parcerias, determinada pela taxa de transmissão entre o nó que compartilha e o nó que recebe: verifica se tinha um canal melhor (maior capacidade de transmissão se comparado ao canal utilizado) entre o nó provedor e o nó receptor.

% \subsection{Definição dos parâmetros do GMTP}
% 
% Olhar o capítulo 4 da tese da nandita para ver os valores dos parâmetros que ela usou
% ver a página 99 para discussões sobre os valores de alfa e beta
% 
% \begin{table}[b!ht]
%   \centering
%   \caption{Tabela dos parâmetros específicos do GMTP.}
%   \renewcommand{\arraystretch}{1}% Spread rows out...
%   \begin{tabular}{>{}m{2in} >{}m{2in}}
%     \toprule
%     \textbf{Parâmetros} & \textbf{Valores} \\
%     \midrule
%      &  \\
%      &  \\
%      &  \\
%     \bottomrule
%   \end{tabular}
%   \label{tb:gmpt-params}
% \end{table}

\subsection{População e amostras}

Constituiu-se a população por dados coletados durante a execução dos ensaios referentes às variáveis dependentes apresentadas na Tabela~\ref{tb:variaveis-dependentes}, com granularidade das amostras em segundos. O tempo de duração de cada ensaio foi de \ut{900}{s}, portanto coletou-se 900 amostras para cada variável dependente em um determinado tratamento.

% % \subsection{\textit{Design} de experimentos}
% 
% Como em uma rede de computadores erros frequentemente ocorrem nas transmissões, se fez necessário \textit{um design} de experimento com replicação. Assim o projeto de experimento escolhido obedece ao \textit{design} $2^k*r$, onde $k=3$ (três níveis) e $r=30$ (trinta replicações por tratamento).

\subsection{Tratamentos}

Na Tabela~\ref{tb:tratamentos}, apresentam-se os tratamentos considerados no experimento, definidos com base na combinação dos fatores apresentados na Tabela~\ref{tb:fatores}. Definiu-se como  as unidades experimentais o GMTP, o Denacast/CoolStreaming e o CCN-TV, comparados em confrontos dois-a-dois, fixando-se o GMTP, em execuções não simultâneas. Dessa forma, executaram-se $36$ tratamentos, sendo $18$ correspondentes ao confronto GMTP vs. Denacast/CoolStreaming e $18$ correspondentes ao confronto GMTP vs. CCN-TV.

\begin{table}[b!ht]
  \centering
  \caption{Tabela dos tratamentos executados no experimento.}
  \renewcommand{\arraystretch}{1}% Spread rows out...
  \begin{tabular}{ccc}
    \toprule
    \textbf{Tratamento \#} & \textbf{Número de nós servidores} & \textbf{Número de nós clientes} \\
    \midrule
    1  & 1 & 500 \\
    2  & 1 & 1.500 \\
    3  & 1 & 15.000 \\
    4  & 1 & 30.000 \\
    5  & 1 & 60.000 \\
    6  & 1 & 80.000 \\
    7  & 1 & 100.000 \\
    8  & 3 & 500 \\
    9  & 3 & 1.500 \\
    10  & 3 & 15.000 \\
    11 & 3 & 30.000 \\
    12 & 3 & 60.000 \\
    13 & 3 & 80.000 \\
    14 & 3 & 100.000 \\
    15 & 7 & 500 \\
    16 & 7 & 1.500 \\
    17 & 7 & 15.000 \\
    18 & 7 & 30.000 \\
    19 & 7 & 60.000 \\
    20 & 7 & 80.000 \\
    21 & 7 & 100.000 \\
    \bottomrule
  \end{tabular}
  \label{tb:tratamentos}
\end{table}

Com relação a execução de cada tratamento, estabeleceu-se a repetição inicialmente de $50$ ensaios e calculou-se as médias $\mu$ das amostras correspondentes às variáveis dependentes apresentadas na Tabela~\ref{tb:variaveis-dependentes}. Em seguida, a fim de obter um nível de confiança de \ut{95}{\%} das medidas obtidas entre os confrontos considerados, calculou-se a inequação de proporcionalidade~\ref{eq:n-confianca}, com $\mu_2 > \mu_1$, utilizada para determinar o tamanho das amostras a fim de comparar duas alternativas~\cite{jain1991}. Como nesse estudo consideraram-se $6$ variáveis dependentes (Tabela~\ref{tb:variaveis-dependentes}), determinou-se $n = max(n_{ST}, n_{IC}, n_{DI}, n_{QS}, n_{QP}, n_{PC})$, sendo cada tratamento repetido $n+1$ vezes.

\begin{equation}
\mu_1 - 1.96 \sqrt{\frac{0,995\mu_1}{n}} \le \mu_2 + 1.96 \sqrt{\frac{0,995\mu_2}{n}}, \mu_2 > \mu_1
\label{eq:n-confianca}
\end{equation} 

Ademais, é importante salientar as seguintes decisões na execução do experimento, aplicadas em todos os ensaios de todos os tratamentos:

\begin{enumerate}

  \item FALAR COMO FOI A DISTRIBUIÇÃO DOS NÓS CLIENTES

  \item Todos os nós clientes, independente do tratamento, solicitaram a recepção da mídia nos primeiros \ut{200}{s} da execução do ensaio;

  \item A estratégia para acionar a requisição de todos os clientes nos primeiros \ut{200}{s} foi a seguinte: gerou-se uma quantidade de números inteiros entre $0-200$ igual à quantidade de nós clientes determinado em um certo tratamento. Por exemplo, no Tratamento $1$ foram gerados $500$ números aleatórios entre $0-200$ e somou-se o número de ocorrência para cada número gerado. Em seguida, adicionou-se à rede a quantidade de nós correspondente ao número de ocorrências em cada instante da simulação. Por exemplo, se o número $199$ foi gerado $10$ vezes, no instante $199$ da simulação foram adicionados $10$ nós clientes que imediatamente solicitaram a mídia. Para essa distribuição deu-se o nome de mapa de conexão.

  \item O mesmo mapa de conexão foi utilizado na execução dos outros sistemas. Isso significa que na execução dos $21$ tratamentos do GMTP, armazenaram-se os mapas de conexão de cada ensaio de todos os tratamento. Em seguida, quando executaram-se os $21$ tratamentos correspondentes ao Denacast e ao CCN-TV, utilizaram-se os mesmos mapas de conexão, em vez de gerá-los novamente. Isto garantiu que nos primeiros \ut{200}{s} os sistemas foram submetidos às mesmas condições iniciais de conectividade de nós clientes.

  \item A função de \textit{churn} foi acionada no instante \ut{400}{s}. A estratégia foi a seguinte: a cada intervalo de \ut{5}{s}, um número \textit{x} $\in$ $[0,1]$ foi gerado. Dependendo do valor de \textit{x}, \ut{10}{\%} dos nós clientes foram mantidos ou removidos com uma probabilidade \textit{p}. Utilizou-se $p=0.7$, isto é, os nós foram mantidos conectados à rede com uma probabilidade de \ut{70}{\%} e removidos com uma probabilidade de \ut{30}{\%}. Para essa distribuição deu-se o nome de mapa de \textit{churn}.

  \item Tal como ocorreu com os mapas de conexão, na execução do GMTP armazenou-se os mapas de \textit{churn} e os mesmos foram utilizados na execução tanto do Denacast quando para o CCN-TV. De forma similar, isto garantiu que todos os sistemas foram submetidos às mesmas condições de dinâmica da rede após os primeiros \ut{400}{s}.

  \item As taxas de upload de cada nó cliente foram distribuídas aleatoriamente para todos os nós clientes, entre as seguintes alternativas: \ut{512}{Kbps}, \ut{1}{Mbps}, \ut{2}{Mbps}. Para isso, deu-se o nome de mapa de taxas de upload. Tal como no caso dos mapas de conexão e \textit{churn}, os mapas de taxas de upload foram reutilizados na execução dos sistemas Denacast e CCN-TV, assegurando-se a mesma capacidade de transmissão dos nós cliente independente dos sistemas.

  \item Em tratamentos com mais de um servidor da mídia transmitida, os nós clientes solicitaram conexão a um servidor escolhido aleatoriamente.

\end{enumerate}


\subsection{Instrumentação}

Com relação à instrumentação, utilizou-se OMNet++~\cite{XU2011,omnetpp2014}, um arcabouço para construção de simuladores de rede. Nesse contexto, utilizaram-se dois simuladores: o OverSim~\cite{oversim2014} e o CCN-Sim~\cite{ccnsim2014}. No OverSim, utilizaram-se as implementações do sistema Denacast/CoolStreaming~\cite{denacast2014} e a do GMTP~\cite{gmtp2014} (implementado no contexto deste trabalho), ao passo que no CCN-Sim, utilizou-se a implementação do CCN-TV~\cite{ccntv2014}.

\subsection{Formato mídia}
\label{subsec:tipomidia}

Na Tabela~\ref{tb:midia-props}, apresentam-se as propriedades da mídia utilizada no experimento~\cite{967596}.

% http://www-tkn.ee.tu-berlin.de/research/trace/ltvt.html

\begin{table}[b!ht]
  \centering
  \caption{Tabela das propriedades da mídia transmitida.}
  \renewcommand{\arraystretch}{1}% Spread rows out...
  \begin{tabular}{>{}m{2in} >{}m{2in}}
    \toprule
    \textbf{Propriedades} & \textbf{Valores} \\
    \midrule
    \textit{Codec} do vídeo & MPEG4 Part I \\
    Mídia sintetizada & Star Wars IV \\
    Número de quadros & \ut{25}{fps} \\
    Número de quadros em GoP & 12 \\
    Média VBR & \ut{512}{Kbps} \\
    \bottomrule
  \end{tabular}
  \label{tb:midia-props}
\end{table}

Dessa forma, com base na metodologia apresentada nesta seção, coletaram-se as amostras para as variáveis dependentes e realizou-se uma análise dos dados para verificar a veracidade ou não das hipóteses levantadas. A seguir, apresentam-se os resultados e discussões no tocante ao desempenho dos sistemas estudados.

\section{Resultados e Discussões}
\label{sec:resdisc}

Nesta seção, apresentam-se os resultados e discussões dos confrontos GMTP vs. Denacast/CoolStreaming e GMTP vs. CCN-TV. Salienta-se que a metodologia discutida anteriormente assegura uma análise estatística dos resultados obtidos e discussões comparativas sobre o desempenho do GMTP em relação aos dois sistemas oponentes considerados, sem garantias estatísticas de comparação e portanto conclusivas entre o Denacast/CoolStreaming e o CCN-TV. Foram executados um total de $2.974$ ensaios, distribuídos nos $42$ tratamentos do experimento.

% Executaram-se $1487$ ensaios para o confronto GMTP vs. Denacast/CoolStreaming e $1487$, totalizando 

% Inicialmente foi feita uma análise estatística da normalidade dos dados com o objetivo de fundamentar a escolha do teste de hipótese adequado a ser usado na análise estatística do  comportamento do protocolo DCCP. Nas subseções seguintes serão exibidos os resultados e discussão referentes às duas análises previamente citadas. 


\subsection{Resultados}

Na Tabela~\ref{tab:resultado-gmtp-denacast}

Na Tabela~\ref{tab:resultado-gmtp-ccntv}

Tentar usar a ideia de destacar algumas linhas e comentá-las

% RESULTADO GMTP VS. DENACAST
\afterpage{%
  \clearpage%
%   \thispagestyle{empty}% empty page style (?)
\begin{landscape}
\renewcommand\multirowsetup{\centering}
\begin{center}
\footnotesize
\begin{longtable}[tp]{c|c|c|c|c|c|c|c}
\caption[Sumário dos valores obtidos para as variáveis dependentes em cada tratamento do confronto GMTP vs. Denacast/CoolStreaming.]{Sumário dos valores obtidos para as variáveis dependentes em cada tratamento do confronto GMTP vs. Denacast/CoolStreaming.} \label{tab:resultado-gmtp-denacast} \\

\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{1.4cm}{\textcolor{black}{\bfseries Trat. \#}}
&
\multirow{2}{2.4cm}{\textcolor{black}{\bfseries Atraso de inicialização (s)}}
&
\multirow{2}{2.7cm}{\textcolor{black}{\bfseries Índice de continuidade (\%)}}
&
\multirow{2}{1.9cm}{\textcolor{black}{\bfseries Distorção do vídeo (\%)}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões ao servidor}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões entre clientes}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Pacotes de controle}}
&
\multirow{2}{0.6cm}{\textcolor{black}{\bfseries n}} \\
%\rowcolor[gray]{0.8}
& & & & & & & \\
\hline \hline
\endfirsthead

\multicolumn{8}{c}%
{{\bfseries \tablename\ \thetable{} -- continuação da página anterior}} \\
\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{1.4cm}{\textcolor{black}{\bfseries Trat. \#}}
&
\multirow{2}{2.4cm}{\textcolor{black}{\bfseries Atraso de inicialização (s)}}
&
\multirow{2}{2.7cm}{\textcolor{black}{\bfseries Índice de continuidade (\%)}}
&
\multirow{2}{1.9cm}{\textcolor{black}{\bfseries Distorção do vídeo (\%)}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões ao servidor}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões entre clientes}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Pacotes de controle}}
&
\multirow{2}{0.6cm}{\textcolor{black}{\bfseries n}} \\
%\rowcolor[gray]{0.8}
& & & & & & & \\
\hline \hline
\endhead

\cline{2-7} \multicolumn{8}{c}{Continuação na próxima página} \\ \hline \hline
\endfoot

\hline \hline
\endlastfoot

\input{analise-desempenho-mudccp-denacast}

\end{longtable}
\end{center}
\end{landscape}
  \clearpage% Flush page
}

% RESULTADO GMTP VS. CCNTV
\afterpage{%
  \clearpage%
%   \thispagestyle{empty}% empty page style (?)
\begin{landscape}
\renewcommand\multirowsetup{\centering}
\begin{center}
\footnotesize
\begin{longtable}[tp]{c|c|c|c|c|c|c|c}
\caption[Sumário dos valores obtidos para as variáveis dependentes em cada tratamento do confronto GMTP vs. CCN-TV.]{Sumário dos valores obtidos para as variáveis dependentes em cada tratamento do confronto GMTP vs. CCN-TV.} \label{tab:resultado-gmtp-ccntv} \\

\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{1.4cm}{\textcolor{black}{\bfseries Trat. \#}}
&
\multirow{2}{2.4cm}{\textcolor{black}{\bfseries Atraso de inicialização (s)}}
&
\multirow{2}{2.7cm}{\textcolor{black}{\bfseries Índice de continuidade (\%)}}
&
\multirow{2}{1.9cm}{\textcolor{black}{\bfseries Distorção do vídeo (\%)}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões ao servidor}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões entre clientes}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Pacotes de controle}}
&
\multirow{2}{0.6cm}{\textcolor{black}{\bfseries n}} \\
%\rowcolor[gray]{0.8}
& & & & & & & \\
\hline \hline
\endfirsthead

\multicolumn{8}{c}%
{{\bfseries \tablename\ \thetable{} -- continuação da página anterior}} \\
\hline\hline
%\rowcolor[gray]{0.8}
\multirow{2}{1.4cm}{\textcolor{black}{\bfseries Trat. \#}}
&
\multirow{2}{2.4cm}{\textcolor{black}{\bfseries Atraso de inicialização (s)}}
&
\multirow{2}{2.7cm}{\textcolor{black}{\bfseries Índice de continuidade (\%)}}
&
\multirow{2}{1.9cm}{\textcolor{black}{\bfseries Distorção do vídeo (\%)}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões ao servidor}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Conexões entre clientes}}
&
\multirow{2}{2.5cm}{\textcolor{black}{\bfseries Pacotes de controle}}
&
\multirow{2}{0.6cm}{\textcolor{black}{\bfseries n}} \\
%\rowcolor[gray]{0.8}
& & & & & & & \\
\hline \hline
\endhead

\cline{2-7} \multicolumn{8}{c}{Continuação na próxima página} \\ \hline \hline
\endfoot

\hline \hline
\endlastfoot

\input{analise-desempenho-mudccp-ccntv}

\end{longtable}
\end{center}
\end{landscape}
  \clearpage% Flush page
}


\subsection{Discussões}

- Gráficos:
    * Número de nós clientes x Qualidade da mídia
    * Número de nós clientes x Atraso de inicialização
    * Protocolo x Conexões servidor x Conexões entre clientes
    * Número de nós clientes x Protocolo x Pacotes de controle
    * Protocolos x Média geométrica (Pensar num gráfico que relacione a média geométrica de todos as variáveis dependentes com os fatores)
    * Algum gráfico guarda-chuva?

Em um contexto geral, comparando em um único número para cada protocolo, fazer um gráfico de barras, usar média geométrica, ou seja:

Dizer que o GMTP tem um melhor desempenho porque a seleção de nós considera a capacidade do canal

O GMTP borda é melhor ligeiramente melhor que o Denacast

Melhorar o capítulo do GMTP em duas coisas: cabeçalho genérico e a parte de seleção dos melhores caminhos com base na capacidade atual do canal (o problema que pode ocorrer é de flash-crowd)

MANTER O PPSP/Swift? Se sim, rever o que o nazareno colocou sobre isso...


% -----------------


% OS PROTOCOLOS DE TRANSPORTE NAO FORAM PROJETADOS/PENSADOS/PREPARADOS PARA P2P
% VER OUTRAS CARACTERÍSTICAS DOS SISTEMAS DE DISTRIBUIÇÃO

CCN-TV 6550523

% - http://named-data.net/wp-content/uploads/2013_Yuan_Infocom_Mini.pdf
  Olhar os gráficos desse artigo

cite 6607500
cite 6386696


\section{Sumário do Capítulo}
\label{sec:resdisc-sumario}

A interoperabilidade é uma medição arquitetural, explicar isso. Como medir a quantidade de aplicações de distribuição de mídias ao vivo diferentes e a quantidade de eventos iguais sendo transmitidos












% \subsection{Considerações sobre Implementação}
% 
% Com o intuito de investigar o desempenho do GMTP, implementou-se no simulador de redes OMNet++~\cite{XU2011} suas principais funcionalidades. A versão  e sua versão atual do protocolo já permite a execução de transmissão de dados. Com o
% desenvolvimento preliminar do protocolo \mudccps no simulador NS-2, permitiu-se
% a execução de diversas simulações a fim de avaliar o comportamento do protocolo
% considerando diversas configurações.
% 
% Em linhas gerais, a implementação no referido simulador de rede permite a
% comunicação entre os nós através dos modos de transmissão multicast e unicast.
% Foram implementados os tipos de pacotes do \mudccps e os processos de
% estabelecimento de conexão, incluindo o processo de uso de nós relays, troca
% de dados em modos multicast e unicast e os algoritmos para controle de
% congestionamento, incluindo o uso de nós reporters.
% 
% Contudo, não foi implementado o arcabouço de extensão para permitir o
% desenvolvimento de novos algoritmos para o processo de conexão, descoberta e
% seleção de nós, adaptação de fluxo de dados e tolerância a falhas. Tal
% implementação será feita no núcleo do sistema operacional Linux, juntamente com
% todos os mecanismos básicos para o funcionamento do \mudccp.
% 
% A proposta é de implementar um arcabouço de extensão para as funções previstas
% no \mudccp, permitindo-se o desenvolvimento e adição de novos algoritmos para
% as funcionalidades supracitadas, de modo que torne o \mudccps flexível para
% permitir que qualquer aplicação os utilizem.
% 
% Na prática, um cenário desejado para essa proposta de implementação do \mudccps
% é que o desenvolvedor possa configurar quais algoritmos deseja utilizar em sua
% aplicação, permitindo-se que estes sejam alterados em modo de execução da
% da mesma. Neste caso, suponha um algoritmo de descoberta de nós chamado
% \textit{DN-1}, um algoritmo para controle de congestionamento chamado
% \textit{CC-2}, um algoritmo de tolerância a desconexão \textit{TD-3}; um
% algoritmo de adaptação de fluxo \textit{AF-4} e um algoritmo para reciprocidade
% % \textit{R-2}. As implementações de tais algoritmos serão feitas na camada de
% transporte, acoplando-as em forma de módulos do sistema operacional ao protocolo
% \mudccp. Em seguida, as aplicações podem selecionar quais algoritmos melhor se
% adequa as suas necessidades, com o \mudccps sendo responsável por:
% 
% \begin{enumerate}
% 
%   \item carregar o conjunto de algoritmos \textit{A = \{DN-1, CC-2, TD-3, AF-4,
% R-2\}};
% 
%   \item definir os parâmetros iniciais para cada um dos algoritmos em A,
% definidos pela aplicação;
% 
%   \item executar funções preliminares para ajustes iniciais, tais como informar
% aos nós participantes de uma transmissão quais dos algoritmos estão sendo
% utilizados (o conjunto \textit{A}) e quais outros estão disponíveis;
% 
%   \item executar os algoritmos em momentos apropriados de acordo com os eventos
% de rede, notificando a aplicação caso necessário e desejável pela aplicação;
% 
%   \item descarregar os algoritmos quando não forem mais necessários e informar
% aos nós parceiros.
% 
% \end{enumerate}
% 
% Desta forma, um nó servidor poderá solicitar que seus nós clientes carreguem um
% determinado módulo, dependendo da sua disponibilidade nos nós clientes. Neste
% caso, o \mudccps controlará todo o processo de carregamento dos mesmos.
% 
% Com isso, o \mudccps se tornará um protocolo extensível que gerencia quais
% algoritmos devem ser executados em cada ponto de extensão. Esses algoritmos
% podem ser adicionados ao protocolo através de módulos do sistema operacional,
% carregáveis utilizando-se comandos como o \textit{modprobe} (no Linux, por
% exemplo) e manipulados (passagem de parâmetros) pela aplicação através de uma
% API de programação, por exemplo, utilizando-se as primitivas
% \textit{setsockopt()} e \textit{getsockopt()} da especificação \textit{BSD
% Socket API}~\cite{1197551}.
% 
% Para que as aplicações possam utilizar o \mudccp, o protocolo deve ser
% compatível com todas as funções prevista na especificação \textit{BSD Socket
% API}, são elas: \textit{socket()}, \textit{bind()}, \textit{listen()},
% \textit{connect()}, \textit{accept()}, \textit{send()}, \textit{recv()},
% \textit{write()}, \textit{read()}, \textit{sendto()}, \textit{recvfrom()},
% \textit{close()}, \textit{select()}, \textit{setsockopt()},
% \textit{getsockopt()} e \textit{pull()}.
% 
% Outros trabalhos podem ser desenvolvidos para tornar o \mudccps compatível com o
% padrão de \textit{sockets} do sistema operacional Windows, conhecido pelo nome
% de \textit{winsock}. Todavia, por ser um sistema operacional de código fechado,
% a implementação do \mudccps só será possível após sua padronização em forma de
% RFC.