\chapter{Introdu\c{c}\~{a}o}
\label{cap:introducao}

% \begin{center}
%     \begin{minipage}{300pt}
%     \small
%     \centering
%       ``Controle de congestionamento está relacionado a como usar a rede da
% forma mais efetiva quanto possível. Atualmente as redes estão super equipadas
% e
% a pergunta mudou de \emph{como eliminar o congestionamento da rede?} para
% \emph{como utilizar de forma eficiente toda a capacidade disponível da
% rede?}''
% (Michael Welzl)
%     \end{minipage}
% \end{center}
% \vspace{1cm}

Os sistemas computacionais baseados em arquiteturas P2P (ponto-a-ponto) são
mundialmente populares porque proporcionam escalabilidade do número de usuários
e reduzem os custos comparados às soluções baseadas em infra-estruturas
centralizadas. Com o número crescente de usuários com conexões de banda larga à
Internet, aumentou-se o consumo de conteúdos multimídia (áudio e/ou vídeo) e a
exigência de qualidade desses conteúdos, elevando-se os custos com largura de
banda dos distribuidores de conteúdo. Por exemplo, estima-se que o YouTube tenha
um custo mensal com largura de banda da ordem de US\$ 1 milhão~\cite{REF}. Esta
é uma grande motivação para a adoção do modelo de serviço P2P para a
distribuição de conteúdos multimídia, em particular os transmitidos ao vivo.

Na prática, os sistemas mais modernos adotam arquiteturas híbrida P2P/CDN
(\textit{Content Delivery Network})~\cite{REF}, pois mantém-se o equilíbrio
entre a qualidade dos conteúdos multimídia e a quantidade de nós que desejam
recebê-los, reduzindo-se o custo com largura de banda. Em sistemas dessa
natureza, os nós estão sempre oferecendo e consumindo recursos uns dos outros,
ao passo que os servidores da CDN organizam os nós da rede P2P e mantêm o
serviço de distribuição mais estáveis. Isto posto, um aspecto importante desses
sistemas é definir de que forma os nós devem escalonar o uso de seus recursos
de forma que a alocação seja a mais equânime e eficiente possível,
evitando-se (i) sobrecarga nos servidores da CDN e nos canais de transmissão e
(ii) a fragmentação de diferentes soluções com o mesmo propósito.

Este trabalho se insere no contexto dos sistemas e protocolos de rede para
distribuição de conteúdos multimídia ao vivo, apresentando como contribuição a
definição, a avaliação e a implementação de um protocolo multi-camada que
explora a relação entre o escalonamento de recursos computacionais em redes P2P,
a qualidade das parcerias formadas entre os nós participantes e os mecanismos
que possam mitigar a complexidade no processo de construção de sistemas de
distribuição de conteúdos multimídia ao vivo, tornando-as compatíveis entre si.

Com esse norte, discute-se os aspectos concernentes a experiência do usuário ao
assistir um conteúdo multimídia ao vivo. Tal experiência está relacionada com o
tempo que um determinado nó leva para começar a reproduzir os primeiros
datagramas (\textit{startup delay time}); com o tempo que um nó leva para voltar
a reproduzir o conteúdo quando seus nós parceiros se desconectam da rede
(\textit{recovery period to restart}); e com a qualidade do conteúdo recebido em
comparação ao conteúdo original (\textit{content distortion}). Estas métricas
são avaliadas sob a perspectiva do protocolo proposto e de um proeminente
sistema de distribuição de conteúdos multimídia ao vivo, o
CoolStreaming~\cite{REF}.

%% Devido a complexidade para realizar experimentos dos
%% cenários de aplicação, constituiu-se os resultados com base em um ambiente de
%% simulação que permite determinar as configurações e avaliar os limites e os
%% impactos dos recursos propostos com relação às métricas de estudo
%estabelecidas.

Atualmente, existem vários casos de sucesso nas áreas de Voz sobre IP (ex.
Skype), Videoconferência (ex. PPLive) e WebTV (ex. Coolstreaming) que utilizam
uma arquitetura híbrida P2P/CDN e nestes casos um nó da rede P2P gera os pacotes
de dados (datagrama) das mídias capturadas e os distribui para outros nós
interessados em reproduzi-los, os quais repassam para outros nós e assim
sucessivamente, à medida que novas partes (\textit{chunks}) do conteúdo são
geradas e obtidas. Neste cenário, os serviços da aplicação são oportunistas,
onde os nós dependem uns dos outros para receberem o conteúdo desejado. Para se
tornar um repassador de conteúdo, o usuário de um nó participante expressa
interesse em um determinado conteúdo, que é reproduzido localmente e repassado
para outros nós. Isto implica que quando o usuário não tem interesse em um
determinado conteúdo, geralmente não se pode utilizá-lo como repassador e
consequentemente seus recursos, por vezes ociosos, não podem ser alocados.

Os cenários de aplicação mais críticos do ponto de vista da ineficiência de
utilização de recursos de rede e no contexto deste trabalho são aqueles que
apresentam um nó de rede gerador de conteúdo e milhares de nós receptores,
estabelecendo portanto uma relação \mys. Tais aplicações compartilham uma
característica comum: a existência de muitos usuários interessados por um mesmo
conteúdo e pouco ou nenhum dado individualizado, ou seja, que precisa ser
transmitido apenas para um usuário ou um grupo restrito deles. Existem diversos
exemplos de aplicações que podem ser citados, principalmente quando se utiliza o
modelo de serviço P2P:

\begin{itemize}
   \item aplicações para transmissão de conteúdo multimídia em tempo real de um
nó da rede para um outro, ou para um conjunto de nós. Por exemplo, sites
\textit{online} como o \murl{livestream.tv}, \murl{ustream.tv},
\murl{twitcam.com} e \murl{streamtheworld.com} permitem que um usuário
transmita conteúdos multimídia do seu computador para milhares de outros
usuários conectados à Internet. Soluções de distribuição de conteúdos multimídia
em tempo real providas por empresas como a Netflix e Youtube também se enquadram
nesta categoria;

   \item aplicações de telefonia IP, tais como o Skype, principalmente
considerando o modo de conversa em grupo;

   \item TV \emph{Online}, por exemplo, transmissões através da Internet de
jogos da copa do mundo ou do campeonato brasileiro de futebol. A rede Globo de
televisão e o Youtube já possui aplicações experimentais para transmissão da
copa do mundo de 2014, com experiências já realizadas na copa américa 2011,
respectivamente;

   \item jogos e rádios \textit{online} e videoconferência 1-para-muitos,
serviços típicos da Internet.
\end{itemize}

----



Apesar do modelo de serviço puramente P2P apresentar um desempenho satisfatório
na transmissão de conteúdos multimídia ao vivo~\cite{REF,REF,REF}, as propostas
promissoras são as que consideram uma arquitetura híbrida P2P/CDN
(\textit{Content Delivery Network})~\cite{REF,REF,REF}
(Figura~\ref{fig:esquema-p2p-cdn}). Um servidor gerador de datagramas multimídia
transmite-os para um conjunto de servidores espalhados
geograficamente em diferentes \textit{backbones} que formam a CDN. Com o suporte
dos nós constituindo uma rede de sobreposição P2P, os servidores da CDN
enviam os datagramas para os nós da rede P2P, que os disseminam para
outros nós interessados pelo mesmo conteúdo. Nesta abordagem, os servidores da
CDN atuam como super nós~\cite{REF} para a rede P2P, ao passo que os nós da rede
P2P cooperam entre si a fim de disseminar mais rapidamente os datagramas, ao
mesmo tempo que os reproduzem localmente. Do ponto de vista de protocolos de
rede, utiliza-se conexões TCP~\cite{REF} para selecionar os nós parceiros e para
troca de mapas de \textit{buffers}; ao passo que transmite-se datagramas
UDP~\cite{REF} contendo os dados da mídia indexados nos mapas de
\textit{buffers}.

\begin{figure}[h]
\begin{center}
\includegraphics[scale=0.4]{imgs/esquema-p2p-cdn.pdf}
\end{center}
\vspace{-1.5cm}
\caption[Esquema de uma arquitetura híbrida P2P/CDN para distribuição de
conteúdo multimídia.]{Estrutura de rede de uma arquitetura híbrida
P2P/CDN para distribuição de conteúdo multimídia.}
\label{fig:esquema-p2p-cdn}
\end{figure}

Com o modelo de serviço híbrido P2P/CDN, permite-se o envio de dados multimídia
para uma maior quantidade de nós sem inundar os servidores com demasiadas
conexões; reduz-se o tráfego de dados nos servidores e o
congestionamento nos canais de transmissão; reduz-se a complexidade do
gerenciamento do serviço e de seus participantes, pois o gerenciamento fica por
conta da CDN e apenas a distribuição do conteúdo por conta da rede
P2P; e proporciona-se um serviço mais estável, melhorando a experiência do
usuário, uma vez que os nós não dependem exclusivamente da rede P2P para
reproduzir o conteúdo de interesse.

A experiência do usuário está relacionada com o tempo que um determinado nó leva
para começar a reproduzir os primeiros datagramas (\textit{startup delay
time}); com o tempo que um nó leva para voltar a reproduzir o conteúdo quando
seus nós parceiros se desconectam da rede (\textit{recovery period to restart});
e com a qualidade do conteúdo recebido em comparação ao conteúdo original
(\textit{content distortion}). Estas são as métricas de estudo deste trabalho,
avaliadas sob a perspectiva de protocolos de rede e sistemas computacionais para
a distribuição de conteúdos multimídia ao vivo.

Nestes sistemas, utilizam-se mecanismos sofisticados para utilizar os recursos
de rede, incluindo os compartilhados pelos nós da rede P2P. Na prática, tais
mecanismos são implementados em forma de protocolos de aplicações de rede com o
intuito de: (i) reduzir altos níveis de congestionamento na rede; (ii) manter a
equidade entre diferentes fluxos transmitidos pelos sistemas finais; e (iii)
selecionar os melhores nós parceiros para cada nó participante. Estes mecanismos
diferem dos sistemas de compartilhamento de arquivos P2P e de mídias sob
demanda. Entender estas peculiaridades é fundamental para proporcionar mudanças
significativas no tocante às métricas de estudo mencionadas anteriormente.

\begin{enumerate}
  \item Nos sistemas distribuição de mídias ao vivo, o usuário de um nó
repassador tem que expressar interesse em um determinado evento no instante da
sua ocorrência e não em um momento futuro. Nos sistemas de compartilhamento de
arquivo, o usuário demonstra interesse em um determinado arquivo e concorda em
mantê-lo localmente para que o sistema compartilhe-o com outros nós em qualquer
momento futuro. Isto possibilita a fácil indexação deste conteúdo e rapidamente
determinar quais nós detem quais conteúdos.

 \item Quando o usuário de um potencial nó repassador não tem interesse em
reproduzir um determinado conteúdo, a aplicação cliente na maioria das vezes não
é executada e portanto a dependência pelo oportunismo por parte desses sistemas
é mais crítica do que nos sistemas de compartilhamento de arquivos. Isto torna a
rede mais dinâmica e consequentemente os sistemas mais instáveis -- há um
impacto direto nos parâmetros que determinam o nível de experência do usuário
devido ao aumento do \textit{churn}~\cite{5680894}.

  \item Nos sistemas de transmissão ao vivo é mais importante a qualidade das
parceria que um determinado nó faz do que a quantidade de parceiros que este
tem. O estado do mapa de \textit{buffer} de reprodução de cada nó da rede é
semelhante, pois não existe a possibilidade de um nó ter um mapa de
\textit{buffer} com muito mais dados para reproduzir do que outros nós. Da mesma
forma que não é possível antecipar datagramas, também não faz sentido mantê-los
no \textit{buffer} de produção por muito tempo. Os datagramas
expiram\footnote{Em  aplicações de transmissão multimídia ao vivo,
estima-se que o \textit{jitter} entre o nó repassador e o nó receptor deve ser
de, no máximo, \ut{180}{ms}} rapidamente e, nestes casos, devem ser descartados
pelas aplicações dos nós que os recebem. Isto indica dois importantes aspectos:

\begin{itemize}

 \item é melhor formar parcerias com poucos nós de boa qualidade do que com
muitos nós de baixa qualidade. A qualidade dos nós parceiros está relacionada
com o quão apto um nó estar em servir outro nó, o que pode ser mensurado, por
exemplo, pela taxa de transmissão, número de saltos ou atraso entre ambos; e

 \item o tamanho necessário para o \textit{buffer} e reprodução deve ser o
suficiente para armazenar alguns segundos da mídia e repassá-la aos
seus nós parceiros.

\end{itemize}


  \item Nos sistemas P2P de transmissão ao vivo, as parcerias são realizadas
entre os nós com interesses comuns por um único conteúdo em um determinado
instante. Por ser um conteúdo ao vivo, os nós geralmente não tem interesse em
receber mais de um conteúdo simultaneamente. Nos sistemas de compartilhamento de
arquivos, os nós formam diferentes parcerias devido aos diferentes arquivos que
estes compartilham.

% Por exemplo, um nó $N_{1}$ pode formar uma parceria com um
% nó $N_{2}$ por interesse em um arquivo $A_{1}$. Porém, $N_{1}$ pode formar uma
% parceria com outro nó $N_{3}$ por interesse em um outro arquivo $A_{2}$, no
% mesmo instante que recebe o arquivo $A_{1}$.

  \item Nos sistemas P2P/CDN de transmissão ao vivo, o caminho dos fluxos de
dados transmitidos por um mesmo servidor da CDN $S_{1}$ para um conjunto de nós
$N_{1} .. N_{n}$, localizados em redes distintas, são mais previsíveis. Isto
possibilita parcerias de melhor qualidade ao levar em consideração que é
possível determinar pontos de intersecção das rotas desses fluxos de dados, uma
vez que estes convergem para um mesmo servidor $S_{1}$. Nestes casos, é possível
enviar apenas um fluxo de dados e replica-lo no ponto de intersecção. Isto
permite o agrupamento e o fomento à cooperação entre eles.

\end{enumerate}

Como consequência das peculiaridades mencionadas anteriormente, neste trabalho
considera-se viável o uso dos roteadores no processo de distribuição do conteúdo
multimídia ao (i) constituir uma rede de sobreposição P2P e (ii) ao coordenar a
seleção de nós parceiros (outros roteadores). Esta é uma tendência recentemente
adotada em protocolos de rede mais modernos e sustentada por uma abordagem
conhecida por Redes Centradas no Conteúdo (\textit{Content Centric Networks} --
CCN), proposta por Van Jacobson, um dos principais proponentes do modelo de
referência TCP/IP~\cite{REF}. O princípio é que uma rede de comunicação deve
viabilizar o acesso ao conteúdo de interesse por um usuário independente do
local físico onde tal conteúdo está armazenado, enfraquecendo arquiteturas
tradicionais da Internet, que impõem uma organização explícita de protocolos em
camadas. Isto deriva do fato de que \ut{90}{\%} do tráfego na Internet consiste
de dados sendo disseminados a partir de uma fonte para diversos
destinos~\cite{REF-WIKI-4}. Além disto, os protocolos de transporte da pilha
TCP/IP não foram projetados para atender as necessidades das aplicações com base
em arquiteturas P2P -- nesta classe de aplicação, quando considerada na
perspectiva do modelo TCP/IP, toda comunicação termina sendo de múltiplos fluxos
\textit{unicast}, quando na prática o principal objetivo é disseminar o mesmo
conteúdo para diversos destinos, o que trás à tona o uso de fluxos
\textit{multicast}. Sendo assim, quando configurados corretamente, os
roteadores, ambientes mais controlados e menos suscintos ao \textit{churn},
podem funcionar como pontes entre a rede de sobreposição P2P e e a redes dos
servidores de uma CDN.




% -----------------


% OS PROTOCOLOS DE TRANSPORTE NAO FORAM PROJETADOS/PENSADOS/PREPARADOS PARA P2P
% VER OUTRAS CARACTERÍSTICAS DOS SISTEMAS DE DISTRIBUIÇÃO

% FAZER FIGURA DE COMO ESTES PARÂMETROS SE RELACIONAM
% startup delay time ->
% recovery period to restart
% content distortion
% vs
% * qualidade das parcerias -> atraso -> pré-definição de rotas (tracer)
% redução do churn (oportunismo) -> melhor startup delay time e recovery period
% to restart -> rede p2p constituída entre os roteadores -> buffer pequeno e
% expiram rapidamente
%


---------------------


Ao longo dos anos, diversos esforços acadêmicos e da indústria foram
feitos para disponibilizar protocolos e sistemas de transmissão para
distribuição de conteúdo ao vivo na
Internet~\cite{wei_modeling_2011,Rod_Dru_2010,agarwal_performance_2008,massoulie_rate-optimal_2008,pelc_push--pull_2007,venot_peer--peer_2007,liang_hierarchically_2007,huang_anysee2:_2007,qi_huang_p2p_2007,xinyan_zhang_coolstreaming/donet:_2005,zhang_large-scale_2005,wakamiya_retransmission_2004,castro_splitstream:_2003}.
As aplicações mais promissoras para este fim são as baseadas no modelo de
serviço P2P. Porém, a disseminação de diferentes sistemas e protocolos de rede
com este propósito tem levado a uma pulverização de soluções para transporte de
dados multimídia na Internet, gerando uma falta de padronização na forma como
essas aplicações são projetadas e implementadas, principalmente por serem
implementadas na camada de aplicação~\cite{yaning_liu_friendly_2008,yan_multimedia-aware_2007,mulabegovic_lightweight_2002}.

Um ponto chave é que as soluções disponibilizadas tentam suprir as limitações
existentes dos protocolos da camada de transporte, tratando-se de soluções
intermediárias e não fundamentais para uma forma efetiva e padronizada para
transportar dados multimídia nas redes de
computadores~\cite{kohler_designing_2006,RFC4336}, salvas suas devidas
contribuições científicas e reais. Desta forma, é premissa no contexto deste
trabalho que soluções mais efetivas no uso de recursos da rede e principalmente
em sua adoção sejam realizadas na camada de transporte e não na camada de
aplicação.

Do ponto de vista da camada de transporte da pilha TCP/IP, existem basicamente
dois protocolos tradicionais, o UDP (\textit{User Datagram Protocol}) e o
TCP (\textit{Transmission Control Protocol}), que não foram projetados para
transporte de dados multimídia na Internet. Ao utilizar o UDP, largamente
adotado na Internet em aplicações multimídia, os desenvolvedores das aplicações
devem implementar seus próprios mecanismos para controle de congestionamento de
datagramas sem garantia de entrega, o que raramente é feito. Nos casos em que se
tenta utilizar TCP em aplicações multimídia em tempo real, o mesmo não apresenta
um desempenho satisfatório porque implementa garantia de entrega com
retransmissão de dados perdidos, uma forma não adequada para aplicações
multimídia com transporte de dados em tempo
real~\cite{leandro-master-2008}, resultando em uma má utilização dos canais de
transmissão de rede quando se considera aplicações para distribuição de
multimídia \mys.

Do ponto de vista de pesquisa acadêmica, existem alguns desafios para o
desenvolvimento de aplicações de rede nesses cenários, tais como: (i) permitir
que fluxos multimídia convivam com fluxos de dados de aplicações
elásticas~\cite{kurose2006} sem que estes últimos sejam degradados pelos
primeiros -- vasta utilização do protocolo TCP; e (ii) evitar perdas excessivas
de dados por parte das aplicações multimídia em questão, pois, neste caso, não
faz sentido retransmitir dados quando estes são perdidos, uma vez que o
conteúdo transmitido por essas aplicações é transiente.

Para viabilizar a utilização de cenários como os apresentados anteriormente,
deve-se abordar problemas relacionados ao gerenciamento de conexão multi-ponto,
incluindo suporte a conexões partindo de diferentes redes e entre uma fonte
transmissora e múltiplos receptores interessados no fluxo multimídia (\mys);
controle de congestionamento na rede, incluindo aspectos de compartilhamento
equânime do canal entre os diversos fluxos de dados e de forma padronizada;
adaptação de fluxo multimídia e qualidade de serviço; segurança; dentre outros.

Nesse contexto, para contemplar requisitos como os mencionados anteriormente,
considera-se que o modelo de serviço de rede mais adequado para abordar
soluções de distribuição de conteúdos multimídia multi-ponto seja o modelo de
serviço entre pares (P2P). Esta escolha é de fundamental importância neste
trabalho porque as tecnologias baseadas em P2P aliviam a carga imposta aos
servidores e aos canais de transmissão das redes. Na arquitetura P2P, cada
participante do sistema pode obter o serviço de visualização da mídia e também
contribuir com outros participantes, fornecendo parte do conteúdo da mídia.
Assim, a banda de rede necessária em u        rti98a w3m único ponto no modelo
cliente-servidor é
compartilhada entre os diversos participantes do sistema~\cite{vieira_borges_2010}.

É no contexto de utilização de conceitos de P2P/CDN com o desenvolvimento de
protocolos de redes para viabilizar transmissões de conteúdos multimídia da
classe de aplicações de rede com apenas um nó gerador de dados e múltiplos nós
receptores (\mys\space) que se insere esse trabalho, motivado pelo grande
interesse de pesquisa, indústria e mercado em evoluir o estado da arte das
soluções para transporte de conteúdos multimídia em larga escala, especialmente
na Internet.  A fim de completar as discussões iniciais nesse contexto, a
seguir,
discutem-se as opções existentes de protocolos de transporte de dados mais
adequados para este fim, uma escolha considerada fundamental neste trabalho.

\subsubsection{Panorama Atual: Protocolos de Transporte da Internet}
\label{sec:panoramaatual}

Atualmente, as principais propostas de protocolos de transporte de dados para
Internet são o TCP, o UDP e o recém padronizado DCCP (\textit{Datagram
Congestion Control Protocol})~\cite{RFC4340,citeulike:943036}. Quando se projeta
um protocolo de rede para transporte de dados nos cenários discutidos
anteriormente, deve-se levar em consideração as características da aplicação
para que se possa obter resultados significativos na qualidade do fluxo de dados
multimídia sendo transmitido e na eficiente utilização dos recursos da rede.
Porém, nota-se que os protocolos da camada de transporte existentes são
limitados com vista aos cenários de distribuição de conteúdo \mys\space e
envolvendo suporte a controle de congestionamento.

O protocolo UDP tem sido largamente utilizado em aplicações
multimídia em tempo real por ser um protocolo simplificado, fazendo uso
apenas do serviço de melhor esforço do IP para transmitir dados na
Internet. Com o passar dos anos e antes do DCCP, o UDP se tornou a
primeira e única opção para transmissão de dados multimídia em tempo
real, porém gerando diversos efeitos colaterais nas grandes redes,
os quais são discutidos a seguir e com vastas referências na
literatura~\cite{RFC4336,leandro2008,ccnc-leandro2008,leandro-master-2008,hong_evaluating_2001,citeulike:943036}.

Para se ter uma idéia dos efeitos colaterais gerados na rede com o uso do UDP,
observe o gráfico \textit{vazão} $\times$ \textit{tempo} ilustrado na
Figura~\ref{fig:tcpudp}. Este gráfico corresponde a um ensaio realizado com
a transmissão de $1$ fluxo TCP competindo com $3$ fluxos de áudio UDP em uma
rede \textit{Ethernet} de \ut{100}{Mbps}. Observe que
o UDP sempre ocupa o máximo da largura de banda disponível na rede ao passo que
não oferece chances para outros fluxos utilizarem o canal, como é o caso do TCP.
Por este motivo, o UDP sempre se apresenta com altas taxas de perda de pacotes,
sobretudo quando há congestionamento na rede. No caso deste ensaio, nos
primeiros \ut{50}{s}, quando não disputava com nenhum outro fluxo, o fluxo TCP
utilizou a rede de forma satisfatória, alcançando uma vazão em torno de
\ut{20}{Mbps}. Entretanto, após esta fase, quando os três fluxos UDP foram
transmitidos na rede, a vazão do fluxo TCP reduziu praticamente para 0 (zero),
permanecendo assim até o final do ensaio.

\begin{figure}[h]
\begin{center}
\includegraphics[scale=0.65]{imgs/tcp-udp3-throughput_normal.pdf}
\end{center}
\vspace{-0.5cm}
\caption[Vazão do TCP $\times$ UDP]{TCP $\times$ UDP. Após \ut{50}{s} do início
do experimento, o fluxo UDP ocupa toda a largura de banda disponível na rede.
Fonte: \protect\cite{leandro-master-2008}.}
\label{fig:tcpudp}
\end{figure}

O protocolo TCP, por sua vez, atende de forma satisfatória às aplicações que
toleram atrasos na entrega de dados e que exigem que estes sejam todos entregues
corretamente e em ordem (aplicações elásticas). Porém, em se tratando de
transporte de dados multimídia em tempo real, o TCP se torna o protocolo menos
apropriado para este fim, pelo menos comparando-o com o UDP e o DCCP. Nas
aplicações de fluxo multimídia em tempo real, é preferível manter o fluxo de
dados e reproduzir o conteúdo que chega a esperar que a informação perdida seja
retransmitida, mesmo diante do fato de que parte dos dados da aplicação tenha
sido perdida. Ao utilizar o TCP, isto não é possível. O principal motivo é que o
TCP implementa entrega confiável de dados adotando a abordagem de retransmitir
qualquer dado perdido. Esta estratégia resulta em atrasos indesejáveis quando se
trata de transmissão de dados multimídia em tempo real, fazendo com que o
usuário perceba interrupções na reprodução do conteúdo.

Em condições de congestionamento na rede, o atraso fim-a-fim aumenta e
conseqüentemente degrada a qualidade do conteúdo multimídia sendo transmitido.
Esta situação se agrava com a retransmissão de pacotes perdidos e que podem não
fazer mais sentido para a aplicação receptora devido ao comportamento transiente
dos fluxos multimídia, em particular os transmitidos em tempo real. Neste caso,
se os pacotes de dados retransmitidos não alcançarem o receptor até um
determinado instante, estes serão descartados ao preço do desperdício no uso dos
recursos da rede, pois \textit{buffers} dos roteadores são alocados para
processar e repassar pacotes que terminam sendo inúteis às aplicações.

O comportamento do TCP para situações como a mencionada anteriormente pode ser
observado no gráfico ilustrado na Figura~\ref{fig:tcp-multimidia-udp}. No ensaio
realizado, transmitiu-se um áudio com duração de \ut{100}{s}, sendo armazenado
no destino e em seguida comparado com o original. Neste caso, constatou-se que
apenas \ut{32}{\%} do áudio alcançou o destino, fato ocorrido devido ao excesso
de retransmissões de pacotes que foram perdidos na rede quando considerados
fluxos TCP disputando com fluxos UDP e a rede apresentando altos níveis de
congestionamento.

\begin{figure}[ht]
\begin{center}
\includegraphics[scale=0.45]{imgs/tcp-reno_udp.pdf}
\end{center}
\vspace{-0.5cm}
\caption[TCP Reno $\times$ UDP com TCP transmitindo áudio]{TCP Reno $\times$
UDP, sendo o TCP enviando um arquivo de áudio. Fonte:
\protect\cite{leandro-master-2008}.}
\label{fig:tcp-multimidia-udp}
\end{figure}

Com apenas essas duas opções para transporte de dados na Internet e
objetivando promover melhorias nos serviços oferecidos pelas
aplicações multimídia, a IETF (\textit{Internet Engineering Task Force}) aprovou
a especificação do protocolo DCCP para transporte de dados multimídia para
Internet. É um protocolo orientado à conexão, não garante entrega e nem
ordenação dos dados transmitidos, todavia, o DCCP implementa controle de
congestionamento para transmissão não-confiável de fluxo de dados
\cite{leandro2008,RFC4340}.

O DCCP herda do TCP as características de ser orientado
à conexão e fornecer controle de congestionamento. Do UDP, o DCCP
herda as características de não garantir entrega e nem ordenação dos
dados transmitidos. Além destas características, no DCCP foram adicionados dois
conceitos novos: a escolha tardia de dados~\cite{kohler05dccp} e um
arcabouço para gerenciamento dos algoritmos de controle de
congestionamento de forma modular. A escolha tardia de dados permite
a mudança de dados de um pacote mesmo depois que estes dados já tenham
sido enviados para a camada de transporte, mas ainda não tenham sido
enviados através da rede -- isto é um alternativa ao mecanismo de retransmissão
do TCP. Já o arcabouço de gerenciamento de algoritmos de controle de
congestionamento permite adicionar novos algoritmos de controle de
congestionamento à aplicação e substituí-los mesmo que uma conexão DCCP já tenha
sido estabelecida.

Para entender as melhorias providas pelo protocolo DCCP, considere o
gráfico \emph{vazão $\times$ tempo} apresentado na
Figura~\ref{fig:tcpdccp}~\cite{leandro-master-2008}. Neste gráfico, ilustram-se os
comportamentos dos protocolos TCP e DCCP quando utilizados para
transmissão de um arquivo e de um conteúdo multimídia,
respectivamente. A partir do gráfico, é possível constatar que os
protocolos TCP e DCCP compartilham entre si a largura de banda
disponível, onde cada fluxo consegue transmitir dados na rede. Note
que o comportamento do protocolo TCP para os \ut{50}{s} iniciais foi
similar ao confronto TCP $\times$ UDP (Figura~\ref{fig:tcpudp}).
Porém, diferentemente do que ocorreu naquele caso, após os primeiros
\ut{50}{s} dos confrontos TCP $\times$ DCCP, a vazão do protocolo
TCP continuou sendo satisfatória, assim como a do DCCP.

\begin{figure}[ht]
\begin{center}
\includegraphics[scale=0.65]{imgs/tcp-dccp_ccid2-throughput_normal.pdf}
\end{center}
\vspace{-0.5cm}
\caption[Vazão do TCP $\times$ DCCP]{TCP $\times$ DCCP. Ambos os protocolos
conseguem transmitir dados na rede. Fonte: \protect\cite{leandro-master-2008}.}
\label{fig:tcpdccp}
\end{figure}

%A \textit{Escolha Tardia de Dados} é uma funcionalidade prevista no protocolo
% DCCP e que não está presente no TCP e
%no UDP. Este mecanismo do DCCP permite que uma aplicação troque o conteúdo de
% um pacote mesmo depois que ele já tenha %sido enviado pela aplicação através
% de uma chamada de sistemas, \textit{send()} ou \textit{write()}, por exemplo.
% Este %mecanismo é muito importante para protocolos que implementam controle de
% congestionamento porque, em caso de %congestionamento, os dados enviados pela
% aplicação serão retidos no \textit{buffer} de saída até que o algoritmo de
% controle de %congestionamento autorize sua transmissão, o que atrasará a
% entrega desses dados. Os dados da aplicação já enviados por ela, %mas que
% ainda estão no \textit{buffer} de saída, poderão não fazer mais sentido para a
% aplicação remota, trocá-los ou cancelar %seu envio pode reduzir o uso de
% recursos de rede, o que contribui para reduzir o congestionamento na rede.
%Para entender melhor este conceito, considere
%a seguinte analogia: suponha o trânsito da
%Avenida Fernandes Lima (uma movimentada avenida da cidade de Maceió). Esta
%avenida é o eixo principal que dá acesso a outras vias que ligam diversos
%bairros da cidade. O fluxo de veículos próximo às \ut{8}{h} ou próximo às
%\ut{18}{h} é muito intenso. Vários semáforos controlam o tráfego, de modo que o
%congestionamento de veículos seja o mínimo possível. Nenhum agente externo
%controla esses semáforos. Se uma ambulância precisar ter prioridade de
%ultrapassagem no trânsito ou precisar ultrapassar no sinal vermelho não há uma
%maneira para especificar qual veículo deve passar e quais devem dar passagem, a
%família do paciente precisará contar com a boa educação dos demais.
%Para este exemplo, o trânsito controlado pelos semáforos equivale ao controle
% de
%congestionamento do protocolo TCP, onde os veículos trafegam baseando-se em
%regras pré-definidas: temporizadores dos semáforos e a interligação dos mesmos.
%A falta de um agente que permita especificar qual veículo tem maior prioridade,
%pode-se comparar a impossibilidade que o TCP impõe de não permitir, caso seja
%necessário, especificar qual pacote deve ser enviado (a urgência que a
%ambulância tem) e quais os que não precisam ser enviados, por exemplo, a mesma
%ambulância se o paciente for a óbito -- não faz sentido retransmitir pacotes
%caso estes sejam descartados no seu destino.
%Para uma segunda situação, não seria difícil de imaginar o que aconteceria se
%nesses horários todos os semáforos não estivessem funcionando. Uma vez que o
%trânsito estaria em um total descontrole, todos os veículos iriam trafegar sem
%nenhum controle adequado, causando acidentes (a perda de pacotes). Este simples
%exemplo poderia comparar-se ao protocolo UDP, que não fornece o controle de
%congestionamento e como conseqüência pode gerar um aumento do congestionamento
%do trânsito, ou melhor, da rede.
%
%Utilizando como base a analogia descrita anteriormente, o DCCP funciona de modo
%a permitir que a ambulância ganhe passagem no trânsito considerando que ainda
% há
%esperança de salvar o paciente. Neste caso, a ambulância seria um pacote
%multimídia que está prestes a ser reproduzido pela aplicação de destino e se
%não chegar a tempo o paciente vai a óbito, ou seja, não fará mais sentido
%reproduzir aquele pacote atrasado. Na prática, o pacote será descartado na
% aplicação de
%destino, utilizando-se a rede para transportar pacotes inúteis à aplicação.
% Mas,
%se existir uma outra ambulância que transporte um paciente ainda vivo -- uma
%nova informação do conteúdo multimídia sendo transmitido -- é preferível
%transmitir este pacote a enviar o paciente em óbito, ou seja, aquele pacote que
%não será mais útil àquela aplicação.

% \subsubsection{Arcabouço Modularizado de Algoritmos de Controle de
% Congestionamento}
% 
% O DCCP oferece três algoritmos de controle de congestionamento,
% chamados CCIDs (\textit{Congestion Control IDentifiers}). Os CCIDs
% são os componentes responsáveis por oferecer o controle de
% congestionamento em conexões DCCP. No Linux, os CCIDs são módulos do
% \emph{kernel} que funcionam sobre o núcleo da implementação do DCCP.
% Como tal, podem ser carregados e descarregados a qualquer momento, e
% as aplicações podem selecionar um CCID adequado para um determinado
% padrão de fluxo multimídia. Por exemplo, aplicações VoIP são
% caracterizadas pela transmissão de rajadas de pequenos pacotes
% seguidas de períodos de silêncio, enquanto aplicações de vídeo sob
% demanda geralmente transmitem conteúdo multimídia a taxas
% constantes. Nesse caso, para uma aplicação VoIP é melhor usar uma
% técnica de controle de congestionamento criada para VoIP. Esta idéia
% não se aplica em protocolos como o TCP e o UDP.
% 
% Os CCIDs padronizados são: CCID-2~\cite{RFC4341},
% CCID-3~\cite{RFC4342} e o CCID-4~\cite{RFC5622}. O CCID-2 (RFC 4341)
% é melhor para aplicações que usam toda a banda de rede disponível e
% se adaptam a alterações súbitas de banda. Assemelha-se ao controle
% de congestionamento do TCP, que se baseia no conceito de janela de
% congestionamento. O tamanho dessa janela determina quantos pacotes o
% remetente tem permissão para enviar pela rede. Isso significa que
% quanto maior for a janela de congestionamento, mais pacotes o DCCP
% está autorizado a enviar dados pela rede.
% 
% Quando o CCID-2 detecta que um pacote foi perdido, ele diminui pela
% metade a janela de congestionamento. Tal ação caracteriza uma
% mudança abrupta na taxa de transmissão, principalmente para
% aplicações multimídia. No estado inicial de transmissão, a janela de
% congestionamento aumenta de forma exponencial conforme os pacotes
% enviados são confirmados, até alcançar a fase de contenção do
% congestionamento. Na fase de contenção, a taxa de transmissão
% aumenta linearmente até que aconteça o primeiro evento de perda de
% pacote.
% 
% O CCID-3 (RFC 4342) implementa um algoritmo de controle de
% congestionamento baseado no receptor, que controla a taxa do
% remetente. Periodicamente, o receptor envia ao remetente pacotes de
% informação relatando eventos de perda e outras estatísticas de
% conexão que são inseridas na equação do TFRC (TCP-\textit{Friendly
% Rate Control}) (RFC 3448). O resultado desta equação corresponde à
% taxa de transmissão que o DCCP deverá utilizar para os próximos
% envios de pacotes.
% 
% %O TFRC é razoavelmente justo quando compete por banda com fluxos
% %TCP, mas tem uma menor variação da taxa de transmissão ao longo do
% %tempo quando comparado a outros mecanismos de controle de
% %congestionamento do TCP. Isso o torna mais adequado a aplicações
% %como telefonia, para as quais é importante uma taxa de envio
% %relativamente suave.
% 
% Por último, a IETF recentemente publicou a RFC
% do CCID-4 (RFC 5622), própria para aplicações que enviam rajadas de
% pacotes pequenos intercalados por intervalos de silêncio. A escrita
% da especificação do CCID-4 também foi uma contribuição no contexto
% deste projeto, sendo as principais: melhoria do texto e
% implementação da especificação no kernel do Linux.

Para transmissões de dados multimídia em redes de computadores, onde
satisfazer os requisitos de tempo pode definir o nível de qualidade
da transmissão multimídia, o DCCP pode melhorar a qualidade do fluxo
multimídia e ainda resolver diversos problemas de congestionamento
da rede, como os causados por retransmissões desnecessárias de
pacotes feitas pelo protocolo TCP ou por problemas de excessiva
perda de pacotes e altos níveis de congestionamento da rede quando se utiliza o
protocolo UDP. Estudos anteriores realizados no contexto deste
trabalho~\cite{leandro-WP2P-2011,leandro-master-2008,leandro2008,leandro-linuxmag2008,ccnc-leandro2008,leandro-OLS-2008} e outros publicados por
terceiros~\cite{5202273,4667595,balan2007,tafazolli2006,linck2006,Shigeki2005,CONG:Nivor05:Video-Exper:inp} constatam que a utilização do protocolo
DCCP tem trazido diversas vantagens na transmissão de fluxos multimídia,
apresentando-se como uma opção efetiva a ser adotada para transmissão de dados
multimídia, principalmente por ter um comportamento similar ao protocolo TCP e
padronizado pela IETF.

Sendo assim, a motivação para a definição do DCCP está relacionada com as
características intrínsecas das aplicações com restrição de tempo de resposta e
no fato de que grande parte desse tipo de aplicação utiliza o UDP. Considerando
os problemas e limitações dos protocolos TCP e UDP discutidos até aqui e os
cenários de aplicações considerados neste trabalho, o DCCP foi projetado para
atender as necessidades das aplicações multimídia com suporte a controle de
congestionamento, evitando assim um colapso de congestionamento na Internet.

Pelo exposto, o protocolo DCCP aparece como o protocolo de transporte mais
adequado a ser utilizado em uma solução para transmissão padronizada de
conteúdos multimídia na Internet. Com isto, elimina-se o uso do protocolo UDP em
aplicações multimídia e consequentemente diminui-se o tráfego de dados na rede
sem controle de congestionamento, ao passo que compartilha-se efetivamente os
canais de transmissão com fluxos de dados TCP, cujas aplicações (\textit{Web},
E-mail etc.) correm o risco de tornarem-se inutilizáveis devido ao iminente e
inevitável crescimento do uso de aplicações multimídia baseadas em UDP.

\section{Descrição do Problema}
\label{sec:problematica}

Apesar da eficiência do DCCP em alguns cenários de transmissão de dados
multimídia na Internet, o mesmo possui falhas críticas quando utilizado em larga
escala em cenários \mys. Além disso, ao longo dos anos o uso de outros
protocolos de transporte para a Internet tem se mostrado pouco efetivo na
prática para a distribuição de conteúdos multimídia em tempo real, tal como o
uso do UDP ou diversas outras propostas não padronizadas, acentuando a motivação
em se desenvolver pesquisas nesse contexto. Isto tem ocorrido porque as soluções
existentes sempre se apresentam de forma independente e sem qualquer preocupação
com sua facilidade de implantação em larga escala.

O que ocorre é que o DCCP é um protocolo orientado à conexão e portanto para
cada novo usuário interessado em receber um fluxo multimídia transmitido, uma
nova conexão se faz necessária. As conseqüências desta limitação do
DCCP são desastrosas, tornando-o um protocolo paradoxal para o que foi proposto.
Em outras palavras, propõe-se com o uso do DCCP resolver os problemas de
congestionamento de rede gerados pelo protocolo UDP em cenários de aplicações
multimídia, porém, quando utilizado em cenários \mys, o protocolo não funciona
devido aos seguintes motivos:

\begin{enumerate}
\item \textit{excessivo consumo de recurso computacional}:
para cada nova conexão, o nó transmissor deve alocar recursos
computacionais (memória e processamento) para tratar cada nova
conexão. Em cenários de transmissão multimídia \mys, se muitos
nós estão conectados em um único servidor, então isto elevará
sobremaneira o consumo de recurso computacional do nó transmissor
proporcionalmente à quantidade de nós receptores interessados pelo
fluxo multimídia transmitido. Além disso, embora o conteúdo transmitido por
um nó seja de interesse de muitos
outros nós, os fluxos são enviados independentemente uns dos outros,
o que gera duplicações desnecessárias e conseqüentemente desperdício
de recursos de rede. O trabalho mais notável que discute as consequências deste problema
em aplicações de rede é o encontrado na referência \cite{guo_survey_2008}.
\item \textit{a taxa de transmissão de fluxos DCCP individualmente tenderá a 0
(zero)}: o protocolo DCCP realiza controle de congestionamento utilizando uma
equação matemática para definir a taxa de transmissão de uma
conexão. À medida que mais nós se conectam a um nó transmissor,
menor será a taxa de transmissão do nó transmissor para cada um dos
nós receptores conectados a ele. Para a rede, esta estratégia é
equânime e evita que a mesma entre em colapso de congestionamento, mas
para cada fluxo de dados isto é ruim. Este problema tem uma relação estreita
com o dilema observado por Garrett Hardin em 1968 e denominado de
\textit{Tragédia dos Comuns}~\cite{tragcomHardin}, apresentando-se em diferentes
áreas do conhecimento. No caso de protocolos como o DCCP, a tragédia dos comuns
ocorre porque à medida que novos fluxos são transmitidos na rede, menor será a
taxa de transmissão individual de cada fluxo, a qual pode se tornar insuficiente
para a recepção de um fluxo multimídia e, por consequência, nenhum nó receptor
reproduzirá o fluxo transmitido pelo nó transmissor, embora todos os fluxos
terão possibilidades semelhantes sobre o uso do canal.

\end{enumerate}

Sendo assim, apesar dos algoritmos de controle de congestionamento serem
corretos visando o caso do melhor global (equidade para com todos os fluxos e
assim evitar congestionamento da rede), isto provoca o efeito do caso do pior
local (redução da taxa de recepção de cada nó da rede).

Este fato pode ser explicado analiticamente utilizando como base a
Equação~\ref{eq:dccpeq-ccid3}, que define cada taxa de transmissão
\textit{$X_i$} calculada pelo DCCP\footnote{Essa equação é utilizada no DCCP
pelo algoritmo para controle de congestionamento chamado de CCID-3
(\textit{Congestion Control IDentifier 3}). Para efeito de estudo, esta equação
foi a escolhida, porém qualquer equação adotada em outros algoritmos para
controle de congestionamento poderia ter sido utilizada.} durante a transmissão
de dados para realizar o controle de congestionamento em cada conexão. Nesta
equação, \textit{$X_i$} é a taxa de transmissão em bytes/segundo, \textit{s} é o
tamanho do pacote em bytes, \textit{R} é o RTT (\textit{Round Trip Time}) em
segundos, \textit{p} é a taxa de ocorrência de perdas, entre 0 e 1, RTO
(\textit{Retransmission TimeOut}) é o valor do temporizador de retransmissão do
TCP em segundos e \textit{b} é igual a 1 e representa o número máximo de pacotes
confirmados por um único ACK.

Considerando o problema descrito anteriormente, o uso total do canal por
\textit{N} fluxos DCCP pode ser definido por $B = \sum_{i=1}^{N} X_i$. Em
condições severas de congestionamento na rede, o valor de \textit{B} é
equivalente à largura de banda do canal de transmissão. Quando isto ocorre,
tem-se que \textit{N} atingiu um valor maior do que a rede suporta, fazendo com
que os \textit{buffers} de recepção dos roteadores alcancem seus limites e
portanto os valores de \textit{p} e \textit{R} na Equação~\ref{eq:dccpeq-ccid3}
também aumentam, resultando que o $\displaystyle\lim_{N\to\infty}\frac{B}{N} =
0$, logo, $X_i$ se aproxima de 0 (zero).

\begin{equation}
X_i = \frac{s}{R \times \sqrt{2 \times b \times \frac{p}{3}} + (RTO \times 3
\sqrt{3 \times b \times \frac{p}{8}} \times p \times (1 + 32 \times p^{2})}
\label{eq:dccpeq-ccid3}
\end{equation}

\vspace{0.5cm}

Embora esta seja uma discussão teórica sobre o principal problema tratado neste
trabalho, também foram realizados e publicados experimentos em busca de
evidências mais contundentes de que este fato ocorre na
prática~\cite{leandro-WP2P-2011,leandro-Globecom-2011}. Foram
executadas simulações de rede no NS-2\footnote{Network Simulator 2:
\murl{http://nsnam.isi.edu/nsnam/index.php/Main_Page}}~\cite{netsimulator2} cuja
topologia da rede foi definida como uma árvore binária completa
(Figura~\ref{fig:topologia_rede}). Cada nó da árvore representou um roteador e
cada roteador tinha 10 nós DCCP receptores conectados a ele. Cada tratamento foi
definido como sendo um nível da árvore binária. Por exemplo, o primeiro
tratamento tinha 10 nós receptores e 1 roteador, pois o nível da árvore
\textit{L} foi igual a 0 (zero); no tratamento seguinte utilizou-se 30 nós
receptores e 3 roteadores, pois L=1; no tratamento seguinte utilizou-se 70 nós
receptores e 7 roteadores, pois L=2; e assim por diante até L=9, quando
utilizou-se 10.230 nós receptores e 1.023 roteadores (utiliza-se $n=2^{L+1}-1$
para se obter a quantidade \textit{n} de roteadores dado um nível \textit{L} da
topologia de rede utilizada). A transmissão ocorreu da seguinte
forma: um nó localizado na raiz da árvore transmitiu o mesmo conteúdo multimídia
para todos os outros nós conectados à rede, simulando uma típica transmissão
multimídia \mys\space e um tráfego de comportamento equivalente a um vídeo
MPEG-2. Em cada tratamento foram estudadas duas variáveis: a perda de dados e a
taxa de transmissão de cada conexão DCCP partindo do nó raiz até cada nó
receptor. As simulações de cada tratamento foram repetidas a quantidade de vezes
necessária até se alcançar uma média com nível de confiança de 95\% para a
métrica vazão, de acordo com o método estatístico descrito no
Capítulo~\ref{cap:metodosexperimentos} deste documento.

Os resultados obtidos com as simulações dos tratamentos descritos anteriormente
são apresentados no gráfico da
Figura~\ref{fig:resultado_simulacao_dccp_many_flows}. Nas abscissas do gráfico
representa-se o número de nós receptores para cada tratamento, ao passo que nas
ordenadas representa-se a taxa de transmissão média conseguida por cada conexão
DCCP, com a porcentagem de perda de dados em cada conexão DCCP em cada ponto
marcado no gráfico.

\begin{figure}[ht]
\begin{center}
\includegraphics[scale=.7]{imgs/topologia.pdf}
\end{center}
\vspace{-0.5cm}
\caption[Topologia da rede definida para as simulações com DCCP]{Topologia da
rede definida para as simulações realizadas. Cada rede é representada por um
roteador e com 10 nós em cada rede.}
\label{fig:topologia_rede}
\end{figure}

\begin{figure}[ht]
\begin{center}
\includegraphics[scale=.85]{graphs/1.pdf}
\end{center}
\vspace{-0.5cm}
\caption[Vazão do DCCP na transmissão de áudio para vários clientes]{Gráfico
para uma transmissão DCCP com um transmissor enviando dados
de áudio VoIP utilizando o protocolo DCCP. Nota-se que a vazão média de cada
fluxo tende a 0 (zero) à medida que o número de nós receptores aumenta.}
\label{fig:resultado_simulacao_dccp_many_flows}
\end{figure}

É possível observar no gráfico apresentado na
Figura~\ref{fig:resultado_simulacao_dccp_many_flows} que a vazão
média de cada fluxo DCCP transmitido aos receptores tende a 0 (zero) à
medida que o número de receptores aumenta, sendo possível concluir
que o protocolo DCCP não escala quando utilizado para transmissão de
dados multimídia em cenários de aplicações com um transmissor
transmitindo para vários receptores (\mys).

Uma questão intrigante neste aspecto é que o protocolo DCCP funciona
perfeitamente em cenários simplórios, mas sofre claramente de um problema de
escalabilidade, o que é crítico para aplicações consideradas neste trabalho, as
quais não podem continuar utilizando protocolos como o UDP pelos efeitos
colaterais causados por este. Isto torna o protocolo DCCP pouco eficaz para
cenários de distribuição de conteúdo multimídia, fazendo com que os
desenvolvedores continuem sem motivações para efetivamente utilizar o protocolo
DCCP em suas aplicações.

Note que apenas fluxos DCCP foram transmitidos neste tratamento, os quais já
foram necessários para causar o problema em questão. Em situações mais
realistas, o problema se torna ainda mais grave, pois o protocolo
DCCP disputará o canal não apenas com outros fluxos DCCP, mas também com fluxos
de protocolos tradicionais, como o TCP e UDP, além de outros protocolos
modernos, como o SCTP~\cite{iyengar_concurrent_2006,huang_multimedia_2011}.

% Embora foi possível constatar o problema na prática, é premissa deste trabalho
% a
% busca sempre por soluções padronizadas para uma efetiva adoção na Internet.
% Desta forma, considera-se como melhor opção utilizar como base o protocolo
% DCCP
% e fornecer soluções viáveis para este problema a continuar utilizando o
% protocolo UDP em transporte de conteúdos multimídia, ou ainda, soluções não
% padronizadas que ao longo de vários anos se mostraram inviáveis ou com baixa
% adoção na prática.

Apesar do protocolo DCCP ter sido utilizado para evidenciar o problema trazido à
tona neste trabalho e assim apresentar resultados concretos, esta discussão pode
ser generalizada em direção a qualquer outro protocolo de rede que seja
orientado à conexão e que suporte mecanismos para controle de congestionamento
de fluxos não confiáveis de dados. A fim de aumentar a representatividade de
protocolos nesse contexto, o leitor pode consultar mais trabalhos nos documentos
referenciados em
\cite{4579599,brosh_delay-friendliness_2010,lucas_fair_2009,ju-won_park_tcp-rome:_2008,elaarag_tcp_2008,RFC4960,lin_ma_congestion_2007,yongxiang_liu_tcp-cm:_2002,brassil_structuring_2002,banerjea_tenet_1996}
e no Capítulo~\ref{cap:trabalhosrelacionados} deste documento.

% Sendo assim, o protocolo DCCP apresenta-se como uma alternativa ao
% UDP em cenários simplórios de transmissão multimídia, mas em
% situações de cenários reais de aplicações multimídia como costuma-se
% encontrar na Internet, o protocolo DCCP não apresenta qualquer possibilidade
% de
% ser utilizado em aplicações multimídia mais complexas, pelo menos da forma que
% atualmente é empregado.

Assim, até o presente momento, os desenvolvedores de aplicações multimídia não
têm outra opção a não ser continuar utilizando o protocolo UDP, porém ao custo
do que já foi discutido anteriormente, ou seja, gerando congestionamentos na
rede e degradando outros fluxos de dados controlados, como os transmitidos pelo
TCP, além de causar um impacto no desempenho das aplicações orientadas a dados.

% Quanto aos desenvolvedores
% de aplicações dentro do escopo deste trabalho que decidirem utilizar UDP
% com suporte a controle de congestionamento na camada de aplicação, estes se
% depararão com mais dois problemas:
% 
% \begin{enumerate}
% \item Desenvolvimento de pelo menos um algoritmo de controle de
% congestionamento na camada de aplicação, o que aumenta na
% complexidade da aplicação; e
% \item Falta de padronização, cada desenvolvedor implementará
% seu algoritmo da forma que desejar.
% \end{enumerate}
% 
% Uma estratégia para abordar o problema aqui discutido e vastamente considerada
% pelos pesquisadores para atender aos requisitos das aplicações estudadas é
% utilizar o modo de transmissão \textit{multicast}. Nestes casos, todos os
% usuários passam a receber o mesmo conteúdo do fluxo de dados sendo
% transmitido ao custo de ser necessário apenas uma única transmissão
% de dados por parte do nó transmissor. Existem na literatura diversos trabalhos
% que adotam tal abordagem~\cite{REF,REF,REF,REF,REF,REF,REF}, sendo que a
% grande
% maioria são baseadas no protocolo UDP e portanto não implementam controle de
% congestionamento, e algumas poucas baseadas no protocolo TCP. Abordagens como
% esta aumenta a complexidade no ponto de vista de desenvolvimento e manutenção
% das aplicações multimídia. Quando se implementa soluções para controle de
% congestionamento na camada de aplicação, quebra-se a filosofia dos protocolos
% em % camadas considerada pelo modelo de serviços TCP/IP. De acordo com suas
% responsabilidades, cada camada deve oferecer serviços para sua camada superior
% e, conseqüentemente, usufruir de serviços da camada inferior. O serviço de
% controle de congestionamento é de responsabilidade da camada de transporte e
% não % na camada de aplicação, evitando assim a pulverização de diferentes
% estratégias % para transporte de dados e/ou a ausência de qualquer mecanismo
% para controle de % congestionamento.
% 
% Ao longo dos anos, tem-se observado que as aplicações multimídia baseadas em
% UDP % na Internet não implementam qualquer solução para controle de
% congestionamento, % pois a maioria dos desenvolvedores estão preocupados com o
% ``negócio'' das suas
% aplicações e não em fazê-las justas para com outros fluxos de dados na rede.

Diante do exposto e buscando melhorar a qualidade dos fluxos de dados multimídia
transmitidos nas redes de computadores, em particular em larga escala na
Internet, pretende-se responder à seguinte questão de pesquisa: \textit{como
transportar dados multimídia para distribuição de conteúdos em topologias de
rede \mys\space com suporte a controle de congestionamento evitando o fenômeno
da tragédia dos comuns e de forma padronizada?}

Observando esta questão que deu origem às pesquisas desenvolvidas
neste trabalho, propõe-se a seguinte tese de doutorado:

\textbf{\textit{O controle de congestionamento baseado na combinação do modo de
transmissão multicast com o compartilhamento de múltiplos fluxos unicasts entre
pares (P2P) realizado na camada de transporte da pilha TCP/IP possibilita a
distribuição padronizada e eficiente de conteúdos multimídia na Internet.}}

\section{Objetivos da Tese}


Neste contexto, propõe-se o
desenvolvimento e a avaliação de um novo protocolo de rede multi-camada chamado
\textit{Global Media Transmission Protocol} (GMTP), para uso em sistemas que
consideram uma arquitetura híbrida P2P/CDN para distribuição de datagramas
multimídia ao vivo em larga escala.


In my thesis I propose a multi-layer network protocol named GMTP (Global Media
Transmission Protocol) for supporting live streaming systems based on a hybrid
P2P/CDN architecture. The GMTP is divided into two parts named GMTP-intra and
GMTP-inter. The GMTP-intra is executed in the end-hosts operated by end-users
that wish to watch an event through a GMTP based client application. The
GMTP-intra may be any desktop-like computer or handheld devices that basically
playback the media content and manages all the connection setup and congestion
control whenever needed. When an end-user wants to watch an event from a
datasource specified by an IP address and port number, the GMTP-intra informs to
the GMTP-inter about the end-user intention. The GMTP-inter is executed in the
routers and effectively constitutes the P2P overlay network by authenticating in
the super seeders (CDN servers), by selecting partner peers and by requesting or
forwarding media content from neighbor routers or to connected end-hosts,
respectively. The GMTP-inter will be normally deployed in routers used by the
ISPs in the users' houses, usually based on the xDSL standard. The GMTP-inter
may authenticate in one or more super seeders from different vendors from a user
friendly setup process available in the router admin panel. GMTP-inter is able
to use unicast or multicast messages to relay the data according to the users
demand. For example, if multiple hosts wish to receive an event transmission,
the router may deliver the data using multicast, but it can use unicast
otherwise. The GMTP-inter is also responsible for exchanging buffer map between
adjacent routers for requesting missing chunks according to its buffer maps.
Each buffer maps is created or destroyed according to the internal peers demand
or depending whether the router is forwarding the media content to another
router or not.

With the goal of generalizing the communication and promote the exchange of data
between different systems, GMTP has been designed to allow the concept of P2P
sockets. When a GMTP based client application wants to receive streaming data,
the connection request may be intercepted by other peers, usually routers,
already receiving the media content. When this occur, the peer reply to the GMTP
client like the original datasource host, that is, the GMTP-intra or GMTP-inter
can accept replies from other peers and not only from the original server, since
the GMTP-inter intercepts requesting packets of the P2P overlay network. The
GMTP uses an algorithm for peer selection based on traceroute and on the delays
between neighbour routers and the datasource host (or the CDN servers). The
traceroute reports are used to find the network distance between two or more
routers and if they may or may not contribute to each other. An incentive
algorithm called Tickets of Bits (ToB) has been defined, so that the more a peer
contributes to the network the more ToB it gets, depending on the level of the
peer contribution. The level of contribution is calculated using a modified
version of the exponentially weighted moving average (EWMA) to avoid outliers
when measuring ToB and also forcing the user to always connect from the same
Internet connection, otherwise it will loose part of its ToB obtained
previously. The end-users can use ToBs to convert it in money credit, discounts
for online purchases and online movie rentals, for example.

The GMTP was inspired in the Dynamic DNS clients, and in the fact that GMTP will
not consume more computational resources than the current routers consume to
make their work. The GMTP relies on the fact that routers always are a mandatory
hop that the packets have to follow and forwarding packets is a common activity
performed by them, a very important task in P2P systems. With this in mind, the
GMTP may execute important functions and transparently serves multiples clients
inside its network, based on the interests in watching one or more events. In
this way, with the deployment of GMTP in the operating systems and in the
routers, it is expected to reduce the churn caused by lack of end-user
interested in watching an event or when they give up to watch an event and close
their client applications. The GMTP-intra is very simple to implement and it can
improve the quality of the media content and reduce the network traffic by
transparently detecting common interests from the users, even those connected to
the Internet on different network and ISPs. Additionally, it may standardize the
deployment of live streaming system because a unique client application can be
able to work with two different systems since GTMP-inter is allowed to
authenticate in one or more CDN infrastructure. It is fully in line with the
recent proposals about Content-Centric Networks promoted by Van Jacobson, at
PARC and highly applied in scenarios where users share their own events from
residential connections to other clients interested on the event, mainly from
web browsers, such as ustream.tv, livestreaming.tv, streamtheworld.com,
coolstreaming.com, pplive.com and many others.


\subsection{Objetivo Principal}

Neste trabalho, tem-se como objetivo principal a concepção e o desenvolvimento
de um protocolo para transporte de fluxos de dados controlados e não confiáveis
para a distribuição de conteúdos multimídia na Internet, considerando-se os
cenários de aplicações \mys. Mais especificamente, propõe-se a
especificação e o desenvolvimento de um protocolo para a classe de aplicações
apresentadas, validando-o através de experimentações e simulações com um
conjunto de ferramentas para dar suporte ao desenvolvimento de aplicações nesse
contexto, assim como promovendo ferramentas para futuras investigações em
pesquisa sobre o protocolo estudado, considerando os seguintes requisitos de
sucesso ao fim deste trabalho.

\begin{itemize}

 \item \textit{Transparência para o desenvolvedor --} deve-se prover um
protocolo de rede que permita ao desenvolvedor, apenas através da utilização
deste protocolo, desenvolver aplicações para envio de dados multimídia em
cenários \mys\space com suporte a controle de congestionamento de fluxo
de dados não confiável. Em momento algum, o desenvolvedor deverá implementar
mecanismos para controle de congestionamento no desenvolvimento de sua
aplicação, bem como outros mecanismos comuns nesse tipo de sistema. Os
mecanismos para controle de congestionamento, assim como os de distribuição de
conteúdo, devem ser transparentes para o desenvolvedor.

 \item \textit{Independência de linguagem e plataforma --} o protocolo proposto
deve ser independente de linguagem de programação ou plataforma específica para
a sua execução. Sendo assim, espera-se que seja possível utilizar tal protocolo
em diferentes contextos de aplicações, considerando diferentes linguagens de
programação, incluindo linguagens populares como C, C++, Java e Python, bem
como sua implementação em diferentes sistemas operacionais.

 \item \textit{Comprometimento com práticas já utilizadas em aplicações
multimídia --} é imprescindível que o protocolo proposto seja capaz de
transmitir dados em modo \textit{multicast} e que suporte algoritmos para
controle de congestionamento neste modo, considerando a restrição de que este
serviço seja implementado na camada de transporte, e não na camada de
aplicação. Esta restrição se estende a funcionalidades como estabelecimento de
conexão, compartilhamento de conteúdos, descoberta e seleção de nós parceiros e
tolerância a falhas.

 \item \textit{Monitoramento e notificação de requisitos mínimos para
transmissão --} o protocolo deve permitir que as aplicações definam requisitos
mínimos de funcionamento para o envio e o recebimento de dados, notificando-as
caso os limiares definidos não sejam cumpridos. Parâmetros como taxa mínima
para transmissão e recepção, além do atraso máximo, figuram como exemplos desses
requisitos. Isto permitirá que as aplicações multimídia construam soluções para
adaptação e transcodificação em tempo real de fluxo de dados multimídia
baseando-se em métricas obtidas de forma padronizada e sem a necessidade de se
implementar na camada de aplicação.

 \item \textit{Especificação do protocolo para uso em larga escala --} o
protocolo deve ser descrito e publicado sob domínio público seguindo o formato
determinado pela IETF (\textit{Internet Engineering Task Force}) e, desta forma,
facilitar a utilização do protocolo em escala global. Isto inclui a
especificação formal do protocolo e sua efetiva validação.

\end{itemize}

\subsection{Objetivos Específicos}

Considerando os requisitos descritos anteriormente, pode-se dividir o objetivo
principal deste trabalho nos objetivos específicos descritos a seguir:

\begin{enumerate}

  \item compreender os sistemas e protocolos para distribuição de conteúdos
multimídia com suporte a controle de congestionamento e multicast, em especial
soluções que fornecem tais funcionalidades na camada de aplicação. Além disso,
entender quais outras funções estão presentes nesse tipo de sistema.

%  \item avaliar o desempenho do protocolo DCCP em redes IP, tais como LANs, WLANs
% e na Internet. A avaliação consiste em um processo comparativo entre o DCCP e os
% protocolos TCP e UDP quando utilizados para transmitir fluxos multimídia nessas
% rede. Esta avaliação é importante porque neste trabalho propõe-se um protocolo
% baseado no DCCP;

%  \item Definir um protocolo na camada de transporte da pilha TCP/IP para
% distribuição de conteúdos multimídia capaz de transmitir dados através do modo
% multicast, sempre que possível, e do modo multi-unicast entre pares quando o
% modo multicast não estiver disponível. Neste contexto, deve-se definir também
% um
% algoritmo para controle de congestionamento em transmissões multicast a ser
% acoplado ao protocolo proposto.

 \item definir um protocolo na camada de transporte da pilha TCP/IP para
distribuição de conteúdos multimídia capaz de transmitir dados através do modo
multicast e do modo multi-unicast entre pares, quando o modo multicast não
estiver disponível. Neste contexto, deve-se definir também um algoritmo para
controle de congestionamento em transmissões multicast a ser acoplado ao
protocolo proposto;

 \item definir um modelo que permita formalizar as características do protocolo
e assim avaliar os aspectos comportamentais dos nós quando o protocolo estiver
em uso, bem como os aspectos da rede, como o consumo de recursos computacionais;

%  \item Definir métricas que permitam avaliar a melhoria de desempenho na
% entrega de dados multimídia quando utilizado o protocolo proposto e outros
% protocolos disponíveis na literatura, inclusive o próprio protocolo DCCP.

% \item Definir uma metodologia para que o protocolo possa ser avaliado de
% acordo com as métricas mais adequadas.

 \item implementar o protocolo e o algoritmo para controle de congestionamento
em um simulador, bem como em um sistema operacional, levando-se em consideração
seus aspectos de extensão de novos algoritmos para as funcionalidades
suportadas pelo protocolo. Isto permitirá validar o seu uso em cenários
reais;

 \item avaliar a relevância do uso do modo multicast e o compartilhamento de
fluxos unicast entre pares com relação à melhoria na qualidade do conteúdo
multimídia recebido pelos nós, assim como no consumo eficiente do canal de
transmissão da rede;

% Neste caso, faz-se necessário visitar os modelos que já
% foram definidos no contexto de distribuição de conteúdo e avaliar o quanto as
% soluções já disponíveis permitem avançar o problema da tregédia dos comuns em
% cenários \mys.

%  \item Definir e implementar diferentes estratégias para eleição de nós
% responsáveis pelo repassa de conteúdos multimídia entre pares, assim como nós
% responsáveis por relatar a taxa de recepção e perdas de dados durante uma
% transmissão. Nesse contexto, deve-se avaliar estas estratégias sob diferentes
% condições ambientais a fim de entender de que forma os nós podem usar os
% resultados deste trabalho para melhorar seu próprio desempenho em
% cenários \mys.

 \item avaliar a capacidade do protocolo em lidar com situações de falhas
(desconexão, por exemplo) de um nó responsável pelo repassar de conteúdos
multimídia. Além disso, avaliar o impacto dessas falhas sob outros nós na
rede, como por exemplo, qual é o impacto sob a qualidade do conteúdo
multimídia recebido por um nó quando há uma falha em um nó de repasse, ou
ainda, qual é o máximo atraso aceitável sem que o usuário perceba interrupções
na reprodução do conteúdo multimídia;

% Outros aspectos que podem ser explorados são
% ataques conhecidos em redes entre pares, especialmente os ataques de
% \textit{Free Riders}~\cite{REF,REF} e o de poluição~\cite{REF,REF,REF}.

%  \item Implementar ferramentas e aplicações (estudos de caso) que permitam
% validar a utilização do protocolo e do algoritmo de controle de
% congestionamento
% propostos.

 \item propor e redigir uma RFC (\textit{Request For Comments}) e submetê-la
para aprovação junto à IETF. Deve-se descrever tecnicamente e em detalhes o
protocolo e os algoritmo envolvidos para a sua devida implementação. Neste
ponto, deve-se também estudar e descrever o grau de compatibilidade do protocolo
proposto com outros protocolos e recomendações anteriormente aprovadas pela IETF
no contexto de transporte de dados multimídia.

\end{enumerate}

\section{Relevância do Tema e da Tese}

Transporte de fluxos de dados multimídia com suporte a controle de
congestionamento para distribuição de conteúdos multimídia, em particular, na
Internet, é um tema relevante no contexto de redes de computadores porque ao
utilizar de forma eficiente e equânime os canais de transmissão, obtêm-se
melhoras da qualidade do conteúdo multimídia percebido pelo usuário. Além
disso, permite-se que aplicações elásticas, como as executadas na
\textit{Web}, funcionem de forma satisfatória. Esta foi a motivação para a
concepção do protocolo de rede proposto no contexto deste trabalho, assim como o
algoritmo para controle de congestionamento a ser utilizado em transmissões de
conteúdos multimídia multicast, principalmente com vista a sua ampla utilização
na Internet.

No caso do tema específico tratado neste trabalho, a distribuição de conteúdos
multimídia em larga escala é cada vez mais relevante devido às características
inerentes à classe de aplicações e cenários que têm sido disponibilizados e
adotados na Internet, tais como controle de congestionamento, sensibilidade a
atrasos e transporte de dados de forma não confiável. Estas características,
aliadas à padronização e à transparência da solução no ponto de vista do
desenvolvedor da aplicação, tornam o tema ainda mais relevante para o contexto
de boas práticas para a distribuição de conteúdos multimídia, especialmente em
cenários \mys.

Como a demanda por serviços multimídia em redes de computadores tem aumentado
dia após dia, o estudo sendo desenvolvido e os artefatos de software produzidos
no contexto desta proposta de tese podem contribuir para o desenvolvimento de
aplicações multimídia mais eficientes e de forma padronizada, além de facilitar
as tomadas de decisões sobre futuros desenvolvimentos desse tipo de aplicação.
Isto é possível porque neste trabalho são apresentados um protocolo para
distribuição de conteúdo multimídia com suporte a controle de congestionamento
na camada de transporte da pilha TCP/IP; resultados e discussões sobre este
protocolo e também sobre o desempenho acerca dos três principais protocolos de
transporte disponíveis para uso na Internet, com destaque para o protocolo DCCP.
Os resultados obtidos nesta última parte foram um dos primeiros a serem
publicados na literatura. Além disso, o autor destaca a importância do presente
trabalho por ser o primeiro a trazer à tona um problema e uma proposta de
solução do uso de um protocolo de transporte exclusivamente projetado para a
distribuição de conteúdos multimídia para a Internet, antes realizada apenas com
o protocolo UDP ou com protocolos independentes implementados na camada de
aplicação.

No que diz respeito à relevância do trabalho, em se tratando de uma proposta
de tese em engenharia de software para redes de computadores, o autor considera
indispensáveis três principais requisitos que estão sendo contemplados e que
reforçam a relevância da tese. Estes requisitos servem como motivação para a
realização das atividades desenvolvidas até o presente momento.

O primeiro deles é a consistência teórica. O protocolo de rede proposto foi
concebido a partir de evidências sólidas com base em experimentos e simulações
de rede, com o problema-chave apresentado e discutido através de fundamentos
matemáticos e provas contundentes através da utilização de um consagrado
simulador de rede. Propõe-se a descrição do protocolo de forma rigorosa e
não-ambígua, permitindo um melhor entendimento e futuros investimentos no
protocolo teórico proposto.

O segundo requisito é a contribuição científica. Diversos trabalhos relacionados
foram estudados antes da concepção do protocolo proposto. A partir deste estudo,
identificou-se o problema anunciado anteriormente e foram elencadas as possíveis
soluções para o problema, o que culminou com a definição deste trabalho. Até o
momento da escrita deste documento e considerando que este é um trabalho ainda
em desenvolvimento, não foram encontrados trabalhos com as características aqui
propostas, o que reforça o caráter de originalidade e contribuição científica, a
qual já vem sendo respaldada pela comunidade através da publicação de artigos em
veículos relevantes da área.

O terceiro requisito é o potencial prático. A implementação do protocolo de
rede, assim como o conjunto de ferramentas que tem sido desenvolvida no contexto
deste trabalho, tem como objetivo demonstrar que a abordagem é viável e
praticável. Um protocolo de rede simplesmente especificado sem nenhuma
implementação real tornaria as reais contribuções deste trabalho apenas
suposições. O compromisso com a utilização dos conceitos para construir
mecanismos que possam ser aplicados na indústria tornam o trabalho relevante em
termos práticos, sobretudo em escala global na Internet.

% \section{Estado Atual do Trabalho}
% 
% De acordo com os objetivos descritos anteriormente, atualmente o trabalho
% encontra-se em fase de desenvolvimento de pesquisas voltadas para a concepção
% de um protocolo de redes chamado de \mudccp.

\newpage

\section{Estrutura do Documento}

O restante deste documento está organizado da seguinte forma:

\begin{itemize}
  \item No Capítulo~\ref{cap:fundamentacao} são apresentados os principais
conceitos relacionados aos sistemas de distribução de mídias ao vivo em
arquiteturas P2P;

  \item No Capítulo~\ref{cap:mudccp} é apresentada uma visão geral do
\textit{Global Media Transmission Protocol} (\mudccp), um protocolo de
transporte baseado em uma arquitetura P2P para distribuição de fluxos de dados
multimídia de aplicações com um nó transmissor e muitos nós receptores (\mys),
desenvolvido para operar principalmente na Internet.

  \item No Capítulo~\ref{cap:mudccp-tecnica} continua-se com as discussões
sobre o protocolo \mudccp, porém fornecendo-se detalhes acerca do funcionamento
do protocolo no tocante a três principais aspectos, o cabeçalho de pacotes, o
processo de conexão e o mecanismo para controle de congestionamento.

  \item No Capítulo~\ref{cap:metodosexperimentos} são apresentados os métodos e
experimentos adotados neste trabalho, destacando-se o mecanismo estatístico
utilizado para obtenção de métricas específicas a fim de analizar o desempenho
do protocolo \mudccps em transmissões de fluxos de dados multimídia.

  \item No Capítulo~\ref{cap:analisedesemp} são apresentados os resultados
preliminares obtidos no contexto deste trabalho, destacando-se os resultados
obtidos em simulações de rede com o uso do protocolo \mudccp, apresentado no
Capítulo~\ref{cap:mudccp}.

  \item No Capítulo~\ref{cap:trabalhosrelacionados} são apresentados os
trabalhos relacionados a esta pesquisa, destacando-se os principais avanços
científicos no que diz respeito a protocolos de transporte com ênfase na
distribuição de conteúdos multimídia utilizando arquiteturas P2P.

  \item Por fim, no Capítulo~\ref{cap:conclusao} são apresentadas as
considerações finais, discutindo-se os principais tópicos elencados
neste trabalho e o planejamento para a conclusão deste trabalho.
\end{itemize}